<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #36c0a0; -webkit-text-stroke: #36c0a0}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 16.0px}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d7378; -webkit-text-stroke: #6d7378}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #b76ff7; -webkit-text-stroke: #b76ff7}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #d4d4d4; -webkit-text-stroke: #d4d4d4}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #71c083; -webkit-text-stroke: #71c083}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #a34f83; -webkit-text-stroke: #a34f83}
    span.s1 {font-kerning: none; color: #b76ff7; background-color: #171818; -webkit-text-stroke: 0px #b76ff7}
    span.s2 {font-kerning: none; background-color: #171818}
    span.s3 {font-kerning: none; color: #36c0a0; background-color: #171818; -webkit-text-stroke: 0px #36c0a0}
    span.s4 {font-kerning: none; color: #d4d4d4; background-color: #171818; -webkit-text-stroke: 0px #d4d4d4}
    span.s5 {font-kerning: none; color: #71c083; background-color: #171818; -webkit-text-stroke: 0px #71c083}
    span.s6 {font-kerning: none; color: #cacaca; background-color: #171818; -webkit-text-stroke: 0px #cacaca}
    span.s7 {font-kerning: none}
    span.s8 {font-kerning: none; color: #6d7378; background-color: #171818; -webkit-text-stroke: 0px #6d7378}
    span.s9 {font-kerning: none; color: #f67c30; background-color: #171818; -webkit-text-stroke: 0px #f67c30}
    span.s10 {font-kerning: none; color: #a34f83; background-color: #171818; -webkit-text-stroke: 0px #a34f83}
  </style>
</head>
<body>
<p class="p1"><span class="s1">import</span><span class="s2"> </span><span class="s3">React</span><span class="s4">,</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> useState</span><span class="s4">,</span><span class="s2"> useRef</span><span class="s4">,</span><span class="s2"> useMemo</span><span class="s4">,</span><span class="s2"> useEffect </span><span class="s4">}</span><span class="s2"> </span><span class="s1">from</span><span class="s2"> </span><span class="s5">'react'</span><span class="s4">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> </span><span class="s2">Upload</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Download</span><span class="s4">,</span><span class="s6"> </span><span class="s2">FileText</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Calendar</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Clock</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Users</span><span class="s4">,</span><span class="s6"> </span><span class="s2">AlertCircle</span><span class="s4">,</span><span class="s6"> </span><span class="s2">CheckCircle</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Filter</span><span class="s4">,</span><span class="s6"> </span><span class="s2">X</span><span class="s4">,</span><span class="s6"> </span><span class="s2">ChevronDown</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Building</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Search</span><span class="s4">,</span><span class="s6"> </span><span class="s2">EyeOff</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Eye</span><span class="s6"> </span><span class="s4">}</span><span class="s6"> </span><span class="s1">from</span><span class="s6"> </span><span class="s5">'lucide-react'</span><span class="s4">;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p4"><span class="s2">// Main App Component: P6 Schedule to CSV Converter</span></p>
<p class="p5"><span class="s2">export</span><span class="s6"> </span><span class="s2">default</span><span class="s6"> </span><span class="s2">function</span><span class="s6"> </span><span class="s3">App</span><span class="s4">()</span><span class="s6"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">file</span><span class="s4">,</span><span class="s2"> setFile</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s1">null</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">parsedData</span><span class="s4">,</span><span class="s2"> setParsedData</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">([]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">isProcessing</span><span class="s4">,</span><span class="s2"> setIsProcessing</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s1">false</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">error</span><span class="s4">,</span><span class="s2"> setError</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">success</span><span class="s4">,</span><span class="s2"> setSuccess</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> fileInputRef </span><span class="s4">=</span><span class="s2"> useRef</span><span class="s4">(</span><span class="s1">null</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">isPdfJsLoaded</span><span class="s4">,</span><span class="s2"> setIsPdfJsLoaded</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s1">false</span><span class="s4">);</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">  </span></span></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// State for filtering and view functionality</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">showFilters</span><span class="s4">,</span><span class="s2"> setShowFilters</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s1">false</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">customKeywords</span><span class="s4">,</span><span class="s2"> setCustomKeywords</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">viewMode</span><span class="s4">,</span><span class="s2"> setViewMode</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s5">'standard'</span><span class="s4">);</span><span class="s2"> </span><span class="s8">// 'standard' or 'dataCentre'</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">selectedTrades</span><span class="s4">,</span><span class="s2"> setSelectedTrades</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">({</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>excavation</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> utilities</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> structural_steel</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> roofing</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>structural_piles</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> concrete_pour</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> concrete_formwork</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>concrete_rebar</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> masonry</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> electrical</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> plumbing</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>hvac</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> insulation</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> drywall</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> flooring</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>painting</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> landscaping</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span><span class="s4">,</span><span class="s2"> other_trades</span><span class="s4">:</span><span class="s2"> </span><span class="s1">false</span></p>
<p class="p6"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">});</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">excludeKeywords</span><span class="s4">,</span><span class="s2"> setExcludeKeywords</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">([</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">'rfp'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'rfi'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'approval'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'submittal'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'review'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'meeting'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'mobilization'</span><span class="s4">,</span><span class="s6"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">'demobilization'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'permit'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'inspection'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'testing'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'close out'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'closeout'</span><span class="s4">,</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">'procurement'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'ordering'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'delivery'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'schedule'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'planning'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'coordination'</span></p>
<p class="p6"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">]);</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// State for standard view table interactions</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">searchQuery</span><span class="s4">,</span><span class="s2"> setSearchQuery</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">selectedActivityIds</span><span class="s4">,</span><span class="s2"> setSelectedActivityIds</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">hiddenActivityIds</span><span class="s4">,</span><span class="s2"> setHiddenActivityIds</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">currentPage</span><span class="s4">,</span><span class="s2"> setCurrentPage</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s9">1</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> itemsPerPage </span><span class="s4">=</span><span class="s2"> </span><span class="s9">20</span><span class="s4">;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Effect to load the pdf.js library</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>useEffect</span><span class="s4">(()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> script </span><span class="s4">=</span><span class="s2"> document</span><span class="s4">.</span><span class="s2">createElement</span><span class="s4">(</span><span class="s5">'script'</span><span class="s4">);</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>script</span><span class="s4">.</span><span class="s6">src </span><span class="s4">=</span><span class="s6"> </span><span class="s2">'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js'</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>script</span><span class="s4">.</span><span class="s2">onload </span><span class="s4">=</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">      </span>window</span><span class="s4">.</span><span class="s6">pdfjsLib</span><span class="s4">.</span><span class="s3">GlobalWorkerOptions</span><span class="s4">.</span><span class="s6">workerSrc </span><span class="s4">=</span><span class="s6"> </span><span class="s2">`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js`</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>setIsPdfJsLoaded</span><span class="s4">(</span><span class="s1">true</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">};</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>script</span><span class="s4">.</span><span class="s6">onerror </span><span class="s4">=</span><span class="s6"> </span><span class="s4">()</span><span class="s6"> </span><span class="s4">=&gt;</span><span class="s6"> setError</span><span class="s4">(</span><span class="s2">"Failed to load PDF processing library."</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>document</span><span class="s4">.</span><span class="s2">body</span><span class="s4">.</span><span class="s2">appendChild</span><span class="s4">(</span><span class="s2">script</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> document</span><span class="s4">.</span><span class="s2">body</span><span class="s4">.</span><span class="s2">removeChild</span><span class="s4">(</span><span class="s2">script</span><span class="s4">);</span><span class="s2"> </span><span class="s4">};</span></p>
<p class="p6"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">},</span><span class="s6"> </span><span class="s2">[]);</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">  </span></span></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Keyword mappings for general trade filtering</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> tradeKeywords </span><span class="s4">=</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>excavation</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'excavat'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'dig'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'earth'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'soil'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'grade'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'cut'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'fill'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'trenching'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'backfill'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>utilities</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'utility'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'utilities'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'water'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'sewer'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'gas'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'electric service'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'storm'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'drain'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>structural_steel</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'steel'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'beam'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'column'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'frame'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'structural steel'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'erection'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'welding'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>roofing</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'roof'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'shingle'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'membrane'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'flashing'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'gutter'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'downspout'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'metal deck'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'roof deck'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>structural_piles</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'pile'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'piles'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'foundation'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'caisson'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'pier'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'deep foundation'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>concrete_pour</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'pour'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'concrete pour'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'placement'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'concrete placement'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'slab'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'footing'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>concrete_formwork</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'form'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'formwork'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'shoring'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'falsework'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'scaffolding'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>concrete_rebar</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'rebar'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'reinforc'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'steel reinforc'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'reinforcing'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'bar'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>masonry</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'masonry'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'brick'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'block'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'stone'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'mortar'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>electrical</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'electrical'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'electric'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'wiring'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'conduit'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'panel'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'lighting'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>plumbing</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'plumb'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'pipe'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'piping'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'fixture'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'valve'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>hvac</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'hvac'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'heating'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'cooling'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'ventilation'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'duct'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'air condition'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>insulation</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'insulat'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'thermal'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'vapor barrier'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'roofing insulation'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>drywall</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'drywall'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'gypsum'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'sheetrock'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'taping'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'finishing'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>flooring</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'floor'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'carpet'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'tile'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'hardwood'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'vinyl'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>painting</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'paint'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'coating'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'finish'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'primer'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>landscaping</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'landscape'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'plant'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'irrigation'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'lawn'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'tree'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>other_trades</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'trade'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'specialty'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'subcontractor'</span><span class="s4">]</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Filtered data for the standard view based on trade filters</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> filteredData </span><span class="s4">=</span><span class="s2"> useMemo</span><span class="s4">(()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(!</span><span class="s2">parsedData</span><span class="s4">.</span><span class="s2">length</span><span class="s4">)</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> </span><span class="s4">[];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> anyTradeSelected </span><span class="s4">=</span><span class="s2"> </span><span class="s3">Object</span><span class="s4">.</span><span class="s2">values</span><span class="s4">(</span><span class="s2">selectedTrades</span><span class="s4">).</span><span class="s2">some</span><span class="s4">(</span><span class="s2">isSelected </span><span class="s4">=&gt;</span><span class="s2"> isSelected</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> hasCustomKeywords </span><span class="s4">=</span><span class="s2"> customKeywords</span><span class="s4">.</span><span class="s2">trim</span><span class="s4">()</span><span class="s2"> </span><span class="s4">!==</span><span class="s2"> </span><span class="s5">''</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> parsedData</span><span class="s4">.</span><span class="s2">filter</span><span class="s4">(</span><span class="s2">activity </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> activityText </span><span class="s4">=</span><span class="s2"> </span><span class="s5">`</span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">name </span><span class="s4">||</span><span class="s2"> </span><span class="s5">''</span><span class="s4">}</span><span class="s5"> </span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">wbs </span><span class="s4">||</span><span class="s2"> </span><span class="s5">''</span><span class="s4">}</span><span class="s5">`</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">excludeKeywords</span><span class="s4">.</span><span class="s2">some</span><span class="s4">(</span><span class="s2">k </span><span class="s4">=&gt;</span><span class="s2"> activityText</span><span class="s4">.</span><span class="s2">includes</span><span class="s4">(</span><span class="s2">k</span><span class="s4">)))</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> </span><span class="s1">false</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(!</span><span class="s2">anyTradeSelected </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">!</span><span class="s2">hasCustomKeywords</span><span class="s4">)</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> </span><span class="s1">true</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> matchesTrade </span><span class="s4">=</span><span class="s2"> anyTradeSelected </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s3">Object</span><span class="s4">.</span><span class="s2">entries</span><span class="s4">(</span><span class="s2">selectedTrades</span><span class="s4">).</span><span class="s2">some</span><span class="s4">(([</span><span class="s2">trade</span><span class="s4">,</span><span class="s2"> selected</span><span class="s4">])</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>selected </span><span class="s4">&amp;&amp;</span><span class="s2"> tradeKeywords</span><span class="s4">[</span><span class="s2">trade</span><span class="s4">]?.</span><span class="s2">some</span><span class="s4">(</span><span class="s2">k </span><span class="s4">=&gt;</span><span class="s2"> activityText</span><span class="s4">.</span><span class="s2">includes</span><span class="s4">(</span><span class="s2">k</span><span class="s4">))</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> matchesCustom </span><span class="s4">=</span><span class="s2"> hasCustomKeywords </span><span class="s4">&amp;&amp;</span><span class="s2"> customKeywords</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">().</span><span class="s2">split</span><span class="s4">(</span><span class="s5">','</span><span class="s4">).</span><span class="s2">map</span><span class="s4">(</span><span class="s2">k </span><span class="s4">=&gt;</span><span class="s2"> k</span><span class="s4">.</span><span class="s2">trim</span><span class="s4">()).</span><span class="s2">filter</span><span class="s4">(</span><span class="s3">Boolean</span><span class="s4">).</span><span class="s2">some</span><span class="s4">(</span><span class="s2">k </span><span class="s4">=&gt;</span><span class="s2"> activityText</span><span class="s4">.</span><span class="s2">includes</span><span class="s4">(</span><span class="s2">k</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">return</span><span class="s2"> matchesTrade </span><span class="s4">||</span><span class="s2"> matchesCustom</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">});</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">},</span><span class="s2"> </span><span class="s4">[</span><span class="s2">parsedData</span><span class="s4">,</span><span class="s2"> selectedTrades</span><span class="s4">,</span><span class="s2"> excludeKeywords</span><span class="s4">,</span><span class="s2"> customKeywords</span><span class="s4">]);</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Data to be displayed in the standard table view, after search and hide filters are applied</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> displayData </span><span class="s4">=</span><span class="s2"> useMemo</span><span class="s4">(()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> lowerCaseQuery </span><span class="s4">=</span><span class="s2"> searchQuery</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> filteredData</span><span class="s4">.</span><span class="s2">filter</span><span class="s4">(</span><span class="s2">activity </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">hiddenActivityIds</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">id</span><span class="s4">))</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> </span><span class="s1">false</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(!</span><span class="s2">searchQuery</span><span class="s4">)</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> </span><span class="s1">true</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">return</span><span class="s2"> </span><span class="s4">(</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>activity</span><span class="s4">.</span><span class="s2">id</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">().</span><span class="s2">includes</span><span class="s4">(</span><span class="s2">lowerCaseQuery</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>activity</span><span class="s4">.</span><span class="s2">name</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">().</span><span class="s2">includes</span><span class="s4">(</span><span class="s2">lowerCaseQuery</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">wbs </span><span class="s4">&amp;&amp;</span><span class="s2"> activity</span><span class="s4">.</span><span class="s2">wbs</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">().</span><span class="s2">includes</span><span class="s4">(</span><span class="s2">lowerCaseQuery</span><span class="s4">))</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">});</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">},</span><span class="s2"> </span><span class="s4">[</span><span class="s2">filteredData</span><span class="s4">,</span><span class="s2"> searchQuery</span><span class="s4">,</span><span class="s2"> hiddenActivityIds</span><span class="s4">]);</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Paginated data for the current page</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> paginatedData </span><span class="s4">=</span><span class="s2"> useMemo</span><span class="s4">(()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s2"> startIndex </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">currentPage </span><span class="s4">-</span><span class="s2"> </span><span class="s9">1</span><span class="s4">)</span><span class="s2"> </span><span class="s4">*</span><span class="s2"> itemsPerPage</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">return</span><span class="s2"> displayData</span><span class="s4">.</span><span class="s2">slice</span><span class="s4">(</span><span class="s2">startIndex</span><span class="s4">,</span><span class="s2"> startIndex </span><span class="s4">+</span><span class="s2"> itemsPerPage</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">},</span><span class="s2"> </span><span class="s4">[</span><span class="s2">displayData</span><span class="s4">,</span><span class="s2"> currentPage</span><span class="s4">]);</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Generalized structured view logic</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> structuredData </span><span class="s4">=</span><span class="s2"> useMemo</span><span class="s4">(()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">viewMode </span><span class="s4">!==</span><span class="s2"> </span><span class="s5">'dataCentre'</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s4">!</span><span class="s2">parsedData</span><span class="s4">.</span><span class="s2">length</span><span class="s4">)</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> </span><span class="s1">null</span><span class="s4">;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> locationKeywords </span><span class="s4">=</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s3">DCH1</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'dch1'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">DCH2</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'dch2'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">DCH3</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'dch3'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">DCH4</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'dch4'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s3">EYD1</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'eyd1'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">EYD2</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'eyd2'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">EYD3</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'eyd3'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">EYD4</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'eyd4'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s3">FSA</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'fsa'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">FUEL_STORAGE</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'fuel storage'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">LOADING_BAY</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'loading bay'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s3">MYD1_BLOCK_1</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'myd1 block 1'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'myd1 blk 1'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">MYD1_BLOCK_2</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'myd1 block 2'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'myd1 blk 2'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s3">MYD2</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'myd2'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">MYD3</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'myd3'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">MYD4</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'myd4'</span><span class="s4">],</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s3">NORTH_LAYDOWN</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'north laydown'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">PERUN</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'perun'</span><span class="s4">],</span><span class="s6"> </span><span class="s3">WASTE_MANAGEMENT</span><span class="s4">:</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'waste management'</span><span class="s4">],</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> grouped </span><span class="s4">=</span><span class="s2"> </span><span class="s4">{};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>parsedData</span><span class="s4">.</span><span class="s2">forEach</span><span class="s4">(</span><span class="s2">activity </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> activityText </span><span class="s4">=</span><span class="s2"> </span><span class="s5">`</span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">name </span><span class="s4">||</span><span class="s2"> </span><span class="s5">''</span><span class="s4">}</span><span class="s5"> </span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">wbs </span><span class="s4">||</span><span class="s2"> </span><span class="s5">''</span><span class="s4">}</span><span class="s5">`</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">for</span><span class="s2"> </span><span class="s4">(</span><span class="s1">const</span><span class="s2"> locKey </span><span class="s1">in</span><span class="s2"> locationKeywords</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">locationKeywords</span><span class="s4">[</span><span class="s2">locKey</span><span class="s4">].</span><span class="s2">some</span><span class="s4">(</span><span class="s2">k </span><span class="s4">=&gt;</span><span class="s2"> activityText</span><span class="s4">.</span><span class="s2">includes</span><span class="s4">(</span><span class="s2">k</span><span class="s4">)))</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(!</span><span class="s2">grouped</span><span class="s4">[</span><span class="s2">locKey</span><span class="s4">])</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>grouped</span><span class="s4">[</span><span class="s2">locKey</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> name</span><span class="s4">:</span><span class="s2"> locKey</span><span class="s4">,</span><span class="s2"> activities</span><span class="s4">:</span><span class="s2"> </span><span class="s4">[]</span><span class="s2"> </span><span class="s4">};</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>grouped</span><span class="s4">[</span><span class="s2">locKey</span><span class="s4">].</span><span class="s2">activities</span><span class="s4">.</span><span class="s2">push</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">);</span></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">                </span></span><span class="s1">break</span><span class="s4">;</span><span class="s6"> </span><span class="s2">// Assign activity to the first location it matches</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">});</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> grouped</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">},</span><span class="s2"> </span><span class="s4">[</span><span class="s2">parsedData</span><span class="s4">,</span><span class="s2"> viewMode</span><span class="s4">]);</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> handleFileUpload </span><span class="s4">=</span><span class="s2"> </span><span class="s1">async</span><span class="s2"> </span><span class="s4">(</span><span class="s2">event</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> uploadedFile </span><span class="s4">=</span><span class="s2"> event</span><span class="s4">.</span><span class="s2">target</span><span class="s4">.</span><span class="s2">files</span><span class="s4">[</span><span class="s9">0</span><span class="s4">];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(!</span><span class="s2">uploadedFile</span><span class="s4">)</span><span class="s2"> </span><span class="s1">return</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setFile</span><span class="s4">(</span><span class="s2">uploadedFile</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setError</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSuccess</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setParsedData</span><span class="s4">([]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setViewMode</span><span class="s4">(</span><span class="s5">'standard'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSearchQuery</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSelectedActivityIds</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setHiddenActivityIds</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setCurrentPage</span><span class="s4">(</span><span class="s9">1</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setIsProcessing</span><span class="s4">(</span><span class="s1">true</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">try</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s2"> extension </span><span class="s4">=</span><span class="s2"> uploadedFile</span><span class="s4">.</span><span class="s2">name</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">().</span><span class="s2">split</span><span class="s4">(</span><span class="s5">'.'</span><span class="s4">).</span><span class="s2">pop</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s2"> content </span><span class="s4">=</span><span class="s2"> </span><span class="s1">await</span><span class="s2"> readFileContent</span><span class="s4">(</span><span class="s2">uploadedFile</span><span class="s4">,</span><span class="s2"> extension </span><span class="s4">===</span><span class="s2"> </span><span class="s5">'pdf'</span><span class="s2"> </span><span class="s4">?</span><span class="s2"> </span><span class="s5">'arrayBuffer'</span><span class="s2"> </span><span class="s4">:</span><span class="s2"> </span><span class="s5">'text'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s2"> activities </span><span class="s4">=</span><span class="s2"> </span><span class="s1">await</span><span class="s2"> parseP6Data</span><span class="s4">(</span><span class="s2">content</span><span class="s4">,</span><span class="s2"> uploadedFile</span><span class="s4">.</span><span class="s2">name</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>setParsedData</span><span class="s4">(</span><span class="s2">activities</span><span class="s4">);</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">      </span>setSuccess</span><span class="s4">(</span><span class="s2">`Successfully parsed </span><span class="s4">${</span><span class="s6">activities</span><span class="s4">.</span><span class="s6">length</span><span class="s4">}</span><span class="s2"> activities`</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>setShowFilters</span><span class="s4">(</span><span class="s1">true</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span><span class="s2"> </span><span class="s1">catch</span><span class="s2"> </span><span class="s4">(</span><span class="s2">err</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>setError</span><span class="s4">(</span><span class="s5">`Error parsing file: </span><span class="s4">${</span><span class="s2">err</span><span class="s4">.</span><span class="s2">message</span><span class="s4">}</span><span class="s5">`</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>setParsedData</span><span class="s4">([]);</span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s4">}</span><span class="s6"> </span><span class="s2">finally</span><span class="s6"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>setIsProcessing</span><span class="s4">(</span><span class="s1">false</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> readFileContent </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">file</span><span class="s4">,</span><span class="s2"> readAs </span><span class="s4">=</span><span class="s2"> </span><span class="s5">'text'</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Promise</span><span class="s4">((</span><span class="s2">resolve</span><span class="s4">,</span><span class="s2"> reject</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s2"> reader </span><span class="s4">=</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">FileReader</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>reader</span><span class="s4">.</span><span class="s2">onload </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">e</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> resolve</span><span class="s4">(</span><span class="s2">e</span><span class="s4">.</span><span class="s2">target</span><span class="s4">.</span><span class="s2">result</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>reader</span><span class="s4">.</span><span class="s2">onerror </span><span class="s4">=</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> reject</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Error</span><span class="s4">(</span><span class="s5">'Failed to read file.'</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">readAs </span><span class="s4">===</span><span class="s2"> </span><span class="s5">'arrayBuffer'</span><span class="s4">)</span><span class="s2"> reader</span><span class="s4">.</span><span class="s2">readAsArrayBuffer</span><span class="s4">(</span><span class="s2">file</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">else</span><span class="s2"> reader</span><span class="s4">.</span><span class="s2">readAsText</span><span class="s4">(</span><span class="s2">file</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">});</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> parseP6Data </span><span class="s4">=</span><span class="s2"> </span><span class="s1">async</span><span class="s2"> </span><span class="s4">(</span><span class="s2">content</span><span class="s4">,</span><span class="s2"> filename</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> extension </span><span class="s4">=</span><span class="s2"> filename</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">().</span><span class="s2">split</span><span class="s4">(</span><span class="s5">'.'</span><span class="s4">).</span><span class="s2">pop</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">switch</span><span class="s4">(</span><span class="s2">extension</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">case</span><span class="s2"> </span><span class="s5">'xml'</span><span class="s4">:</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> parseXMLData</span><span class="s4">(</span><span class="s2">content</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">case</span><span class="s2"> </span><span class="s5">'xer'</span><span class="s4">:</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> parseXERData</span><span class="s4">(</span><span class="s2">content</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">case</span><span class="s2"> </span><span class="s5">'csv'</span><span class="s4">:</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> parseCSVData</span><span class="s4">(</span><span class="s2">content</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">case</span><span class="s2"> </span><span class="s5">'pdf'</span><span class="s4">:</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">            </span></span><span class="s1">if</span><span class="s6"> </span><span class="s4">(!</span><span class="s6">isPdfJsLoaded</span><span class="s4">)</span><span class="s6"> </span><span class="s1">throw</span><span class="s6"> </span><span class="s1">new</span><span class="s6"> </span><span class="s3">Error</span><span class="s4">(</span><span class="s2">'PDF library not loaded. Please wait and retry.'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">return</span><span class="s2"> parsePDFData</span><span class="s4">(</span><span class="s2">content</span><span class="s4">);</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">        </span></span><span class="s1">default</span><span class="s4">:</span><span class="s6"> </span><span class="s1">throw</span><span class="s6"> </span><span class="s1">new</span><span class="s6"> </span><span class="s3">Error</span><span class="s4">(</span><span class="s2">'Unsupported file format. Please upload XML, XER, CSV, or PDF.'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> parseXMLData </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">xmlContent</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> parser </span><span class="s4">=</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">DOMParser</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> xmlDoc </span><span class="s4">=</span><span class="s2"> parser</span><span class="s4">.</span><span class="s2">parseFromString</span><span class="s4">(</span><span class="s2">xmlContent</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"text/xml"</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">xmlDoc</span><span class="s4">.</span><span class="s2">getElementsByTagName</span><span class="s4">(</span><span class="s5">"parsererror"</span><span class="s4">).</span><span class="s2">length</span><span class="s4">)</span><span class="s2"> </span><span class="s1">throw</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Error</span><span class="s4">(</span><span class="s5">"Failed to parse XML file."</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> activities </span><span class="s4">=</span><span class="s2"> </span><span class="s3">Array</span><span class="s4">.</span><span class="s1">from</span><span class="s4">(</span><span class="s2">xmlDoc</span><span class="s4">.</span><span class="s2">getElementsByTagName</span><span class="s4">(</span><span class="s5">"Activity"</span><span class="s4">));</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s6"> </span><span class="s4">(!</span><span class="s6">activities</span><span class="s4">.</span><span class="s6">length</span><span class="s4">)</span><span class="s6"> </span><span class="s1">throw</span><span class="s6"> </span><span class="s1">new</span><span class="s6"> </span><span class="s3">Error</span><span class="s4">(</span><span class="s2">"No activities found in XML file."</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> activities</span><span class="s4">.</span><span class="s2">map</span><span class="s4">((</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> i</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">({</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>id</span><span class="s4">:</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"Id"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"ActivityId"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">`ACT-</span><span class="s4">${</span><span class="s2">i </span><span class="s4">+</span><span class="s2"> </span><span class="s9">1</span><span class="s4">}</span><span class="s5">`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>name</span><span class="s4">:</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"Name"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"ActivityName"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">"Unnamed Activity"</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>startDate</span><span class="s4">:</span><span class="s2"> formatDate</span><span class="s4">(</span><span class="s2">getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"PlannedStartDate"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"StartDate"</span><span class="s4">)),</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>finishDate</span><span class="s4">:</span><span class="s2"> formatDate</span><span class="s4">(</span><span class="s2">getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"PlannedFinishDate"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"FinishDate"</span><span class="s4">)),</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>duration</span><span class="s4">:</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"PlannedDuration"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"Duration"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>percentComplete</span><span class="s4">:</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"PercentComplete"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>totalFloat</span><span class="s4">:</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"TotalFloat"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>status</span><span class="s4">:</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"Status"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">"Not Started"</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>wbs</span><span class="s4">:</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"WBSName"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> getElementText</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> </span><span class="s5">"WBSCode"</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">""</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> parseXERData </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">xerContent</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> lines </span><span class="s4">=</span><span class="s2"> xerContent</span><span class="s4">.</span><span class="s2">split</span><span class="s4">(</span><span class="s5">'\n'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">let</span><span class="s2"> isTaskSection </span><span class="s4">=</span><span class="s2"> </span><span class="s1">false</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">let</span><span class="s2"> headers </span><span class="s4">=</span><span class="s2"> </span><span class="s4">[];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> taskData </span><span class="s4">=</span><span class="s2"> </span><span class="s4">[];</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">for</span><span class="s2"> </span><span class="s4">(</span><span class="s1">const</span><span class="s2"> line </span><span class="s1">of</span><span class="s2"> lines</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> trimmedLine </span><span class="s4">=</span><span class="s2"> line</span><span class="s4">.</span><span class="s2">trim</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">trimmedLine</span><span class="s4">.</span><span class="s2">startsWith</span><span class="s4">(</span><span class="s5">'%T'</span><span class="s4">)</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> trimmedLine</span><span class="s4">.</span><span class="s2">includes</span><span class="s4">(</span><span class="s5">'TASK'</span><span class="s4">))</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> isTaskSection </span><span class="s4">=</span><span class="s2"> </span><span class="s1">true</span><span class="s4">;</span><span class="s2"> </span><span class="s1">continue</span><span class="s4">;</span><span class="s2"> </span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">isTaskSection </span><span class="s4">&amp;&amp;</span><span class="s2"> trimmedLine</span><span class="s4">.</span><span class="s2">startsWith</span><span class="s4">(</span><span class="s5">'%F'</span><span class="s4">))</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> headers </span><span class="s4">=</span><span class="s2"> trimmedLine</span><span class="s4">.</span><span class="s2">substring</span><span class="s4">(</span><span class="s9">3</span><span class="s4">).</span><span class="s2">split</span><span class="s4">(</span><span class="s5">'\t'</span><span class="s4">).</span><span class="s2">map</span><span class="s4">(</span><span class="s2">h </span><span class="s4">=&gt;</span><span class="s2"> h</span><span class="s4">.</span><span class="s2">trim</span><span class="s4">());</span><span class="s2"> </span><span class="s1">continue</span><span class="s4">;</span><span class="s2"> </span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">isTaskSection </span><span class="s4">&amp;&amp;</span><span class="s2"> trimmedLine</span><span class="s4">.</span><span class="s2">startsWith</span><span class="s4">(</span><span class="s5">'%R'</span><span class="s4">))</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">const</span><span class="s2"> values </span><span class="s4">=</span><span class="s2"> trimmedLine</span><span class="s4">.</span><span class="s2">substring</span><span class="s4">(</span><span class="s9">3</span><span class="s4">).</span><span class="s2">split</span><span class="s4">(</span><span class="s5">'\t'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">const</span><span class="s2"> activity </span><span class="s4">=</span><span class="s2"> </span><span class="s4">{};</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>headers</span><span class="s4">.</span><span class="s2">forEach</span><span class="s4">((</span><span class="s2">header</span><span class="s4">,</span><span class="s2"> index</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> activity</span><span class="s4">[</span><span class="s2">header</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> values</span><span class="s4">[</span><span class="s2">index</span><span class="s4">]</span><span class="s2"> </span><span class="s4">?</span><span class="s2"> values</span><span class="s4">[</span><span class="s2">index</span><span class="s4">].</span><span class="s2">trim</span><span class="s4">()</span><span class="s2"> </span><span class="s4">:</span><span class="s2"> </span><span class="s5">''</span><span class="s4">;</span><span class="s2"> </span><span class="s4">});</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>taskData</span><span class="s4">.</span><span class="s2">push</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">isTaskSection </span><span class="s4">&amp;&amp;</span><span class="s2"> trimmedLine</span><span class="s4">.</span><span class="s2">startsWith</span><span class="s4">(</span><span class="s5">'%T'</span><span class="s4">)</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">!</span><span class="s2">trimmedLine</span><span class="s4">.</span><span class="s2">includes</span><span class="s4">(</span><span class="s5">'TASK'</span><span class="s4">))</span><span class="s2"> </span><span class="s1">break</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s6"> </span><span class="s4">(</span><span class="s6">taskData</span><span class="s4">.</span><span class="s6">length </span><span class="s4">===</span><span class="s6"> </span><span class="s9">0</span><span class="s4">)</span><span class="s6"> </span><span class="s1">throw</span><span class="s6"> </span><span class="s1">new</span><span class="s6"> </span><span class="s3">Error</span><span class="s4">(</span><span class="s2">'No TASK records found in the XER file.'</span><span class="s4">);</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> taskData</span><span class="s4">.</span><span class="s2">map</span><span class="s4">((</span><span class="s2">activity</span><span class="s4">,</span><span class="s2"> index</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">({</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>id</span><span class="s4">:</span><span class="s2"> activity</span><span class="s4">.</span><span class="s2">task_code </span><span class="s4">||</span><span class="s2"> </span><span class="s5">`XER-ACT-</span><span class="s4">${</span><span class="s2">index </span><span class="s4">+</span><span class="s2"> </span><span class="s9">1</span><span class="s4">}</span><span class="s5">`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>name</span><span class="s4">:</span><span class="s2"> activity</span><span class="s4">.</span><span class="s2">task_name </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'Unnamed Activity'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>startDate</span><span class="s4">:</span><span class="s2"> formatDate</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">early_start_date</span><span class="s4">),</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>finishDate</span><span class="s4">:</span><span class="s2"> formatDate</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">early_end_date</span><span class="s4">),</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>duration</span><span class="s4">:</span><span class="s2"> activity</span><span class="s4">.</span><span class="s2">target_drtn_hr_cnt </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>percentComplete</span><span class="s4">:</span><span class="s2"> activity</span><span class="s4">.</span><span class="s2">phys_complete_pct </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>totalFloat</span><span class="s4">:</span><span class="s2"> activity</span><span class="s4">.</span><span class="s2">total_float_hr_cnt </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>status</span><span class="s4">:</span><span class="s2"> activity</span><span class="s4">.</span><span class="s2">status_code </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'Not Started'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>wbs</span><span class="s4">:</span><span class="s2"> activity</span><span class="s4">.</span><span class="s2">wbs_id </span><span class="s4">||</span><span class="s2"> </span><span class="s5">''</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> parseCSVData </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">csvContent</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> lines </span><span class="s4">=</span><span class="s2"> csvContent</span><span class="s4">.</span><span class="s2">split</span><span class="s4">(</span><span class="s10">/[\r\n]+/</span><span class="s4">).</span><span class="s2">filter</span><span class="s4">(</span><span class="s2">line </span><span class="s4">=&gt;</span><span class="s2"> line</span><span class="s4">.</span><span class="s2">trim</span><span class="s4">()</span><span class="s2"> </span><span class="s4">!==</span><span class="s2"> </span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s6"> </span><span class="s4">(</span><span class="s6">lines</span><span class="s4">.</span><span class="s6">length </span><span class="s4">&lt;</span><span class="s6"> </span><span class="s9">2</span><span class="s4">)</span><span class="s6"> </span><span class="s1">throw</span><span class="s6"> </span><span class="s1">new</span><span class="s6"> </span><span class="s3">Error</span><span class="s4">(</span><span class="s2">'CSV file must have a header and at least one data row.'</span><span class="s4">);</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> parseCsvRow </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">row</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> result </span><span class="s4">=</span><span class="s2"> </span><span class="s4">[];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">let</span><span class="s2"> current </span><span class="s4">=</span><span class="s2"> </span><span class="s5">''</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">let</span><span class="s2"> inQuotes </span><span class="s4">=</span><span class="s2"> </span><span class="s1">false</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">for</span><span class="s2"> </span><span class="s4">(</span><span class="s1">let</span><span class="s2"> i </span><span class="s4">=</span><span class="s2"> </span><span class="s9">0</span><span class="s4">;</span><span class="s2"> i </span><span class="s4">&lt;</span><span class="s2"> row</span><span class="s4">.</span><span class="s2">length</span><span class="s4">;</span><span class="s2"> i</span><span class="s4">++)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">const</span><span class="s2"> char </span><span class="s4">=</span><span class="s2"> row</span><span class="s4">[</span><span class="s2">i</span><span class="s4">];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">char </span><span class="s4">===</span><span class="s2"> </span><span class="s5">'"'</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">(</span><span class="s2">i </span><span class="s4">===</span><span class="s2"> </span><span class="s9">0</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> row</span><span class="s4">[</span><span class="s2">i</span><span class="s4">-</span><span class="s9">1</span><span class="s4">]</span><span class="s2"> </span><span class="s4">!==</span><span class="s2"> </span><span class="s5">'\\'</span><span class="s4">))</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> inQuotes </span><span class="s4">=</span><span class="s2"> </span><span class="s4">!</span><span class="s2">inQuotes</span><span class="s4">;</span><span class="s2"> </span><span class="s4">}</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">else</span><span class="s2"> </span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">char </span><span class="s4">===</span><span class="s2"> </span><span class="s5">','</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">!</span><span class="s2">inQuotes</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> result</span><span class="s4">.</span><span class="s2">push</span><span class="s4">(</span><span class="s2">current</span><span class="s4">);</span><span class="s2"> current </span><span class="s4">=</span><span class="s2"> </span><span class="s5">''</span><span class="s4">;</span><span class="s2"> </span><span class="s4">}</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">else</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> current </span><span class="s4">+=</span><span class="s2"> char</span><span class="s4">;</span><span class="s2"> </span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>result</span><span class="s4">.</span><span class="s2">push</span><span class="s4">(</span><span class="s2">current</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">return</span><span class="s2"> result</span><span class="s4">.</span><span class="s2">map</span><span class="s4">(</span><span class="s2">v </span><span class="s4">=&gt;</span><span class="s2"> v</span><span class="s4">.</span><span class="s2">trim</span><span class="s4">().</span><span class="s2">replace</span><span class="s4">(</span><span class="s10">/^"|"$/</span><span class="s1">g</span><span class="s4">,</span><span class="s2"> </span><span class="s5">''</span><span class="s4">).</span><span class="s2">replace</span><span class="s4">(</span><span class="s10">/""/</span><span class="s1">g</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'"'</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> headers </span><span class="s4">=</span><span class="s2"> parseCsvRow</span><span class="s4">(</span><span class="s2">lines</span><span class="s4">[</span><span class="s9">0</span><span class="s4">]).</span><span class="s2">map</span><span class="s4">(</span><span class="s2">h </span><span class="s4">=&gt;</span><span class="s2"> h</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">().</span><span class="s2">trim</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> activities </span><span class="s4">=</span><span class="s2"> </span><span class="s4">[];</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> findHeaderIndex </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">possibleNames</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">for</span><span class="s2"> </span><span class="s4">(</span><span class="s1">const</span><span class="s2"> name </span><span class="s1">of</span><span class="s2"> possibleNames</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">const</span><span class="s2"> index </span><span class="s4">=</span><span class="s2"> headers</span><span class="s4">.</span><span class="s2">indexOf</span><span class="s4">(</span><span class="s2">name</span><span class="s4">.</span><span class="s2">toLowerCase</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">index </span><span class="s4">!==</span><span class="s2"> </span><span class="s4">-</span><span class="s9">1</span><span class="s4">)</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> index</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">return</span><span class="s2"> </span><span class="s4">-</span><span class="s9">1</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> idIndex </span><span class="s4">=</span><span class="s2"> findHeaderIndex</span><span class="s4">([</span><span class="s5">'activity id'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'id'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'task id'</span><span class="s4">]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> nameIndex </span><span class="s4">=</span><span class="s2"> findHeaderIndex</span><span class="s4">([</span><span class="s5">'activity name'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'name'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'task name'</span><span class="s4">]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> startIndex </span><span class="s4">=</span><span class="s2"> findHeaderIndex</span><span class="s4">([</span><span class="s5">'start'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'start date'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'planned start'</span><span class="s4">]);</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s6"> finishIndex </span><span class="s4">=</span><span class="s6"> findHeaderIndex</span><span class="s4">([</span><span class="s2">'finish'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'finish date'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'planned finish'</span><span class="s4">]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> durationIndex </span><span class="s4">=</span><span class="s2"> findHeaderIndex</span><span class="s4">([</span><span class="s5">'original duration'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'duration'</span><span class="s4">]);</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s6"> percentIndex </span><span class="s4">=</span><span class="s6"> findHeaderIndex</span><span class="s4">([</span><span class="s2">'activity % complete'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'% complete'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'percent complete'</span><span class="s4">]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> statusIndex </span><span class="s4">=</span><span class="s2"> findHeaderIndex</span><span class="s4">([</span><span class="s5">'activity status'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'status'</span><span class="s4">]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> totalFloatIndex </span><span class="s4">=</span><span class="s2"> findHeaderIndex</span><span class="s4">([</span><span class="s5">'total float'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'total float (days)'</span><span class="s4">]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> wbsIndex </span><span class="s4">=</span><span class="s2"> findHeaderIndex</span><span class="s4">([</span><span class="s5">'wbs name'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'wbs'</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'wbs code'</span><span class="s4">]);</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">for</span><span class="s2"> </span><span class="s4">(</span><span class="s1">let</span><span class="s2"> i </span><span class="s4">=</span><span class="s2"> </span><span class="s9">1</span><span class="s4">;</span><span class="s2"> i </span><span class="s4">&lt;</span><span class="s2"> lines</span><span class="s4">.</span><span class="s2">length</span><span class="s4">;</span><span class="s2"> i</span><span class="s4">++)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> values </span><span class="s4">=</span><span class="s2"> parseCsvRow</span><span class="s4">(</span><span class="s2">lines</span><span class="s4">[</span><span class="s2">i</span><span class="s4">]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">values</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&lt;</span><span class="s2"> headers</span><span class="s4">.</span><span class="s2">length</span><span class="s4">)</span><span class="s2"> </span><span class="s1">continue</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> activity </span><span class="s4">=</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>id</span><span class="s4">:</span><span class="s2"> values</span><span class="s4">[</span><span class="s2">idIndex</span><span class="s4">]</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">`CSV-ACT-</span><span class="s4">${</span><span class="s2">i</span><span class="s4">}</span><span class="s5">`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>name</span><span class="s4">:</span><span class="s2"> values</span><span class="s4">[</span><span class="s2">nameIndex</span><span class="s4">]</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'Unnamed Activity'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>startDate</span><span class="s4">:</span><span class="s2"> formatDate</span><span class="s4">(</span><span class="s2">values</span><span class="s4">[</span><span class="s2">startIndex</span><span class="s4">]),</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>finishDate</span><span class="s4">:</span><span class="s2"> formatDate</span><span class="s4">(</span><span class="s2">values</span><span class="s4">[</span><span class="s2">finishIndex</span><span class="s4">]),</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>duration</span><span class="s4">:</span><span class="s2"> values</span><span class="s4">[</span><span class="s2">durationIndex</span><span class="s4">]</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>percentComplete</span><span class="s4">:</span><span class="s2"> values</span><span class="s4">[</span><span class="s2">percentIndex</span><span class="s4">]</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>totalFloat</span><span class="s4">:</span><span class="s2"> values</span><span class="s4">[</span><span class="s2">totalFloatIndex</span><span class="s4">]</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>status</span><span class="s4">:</span><span class="s2"> values</span><span class="s4">[</span><span class="s2">statusIndex</span><span class="s4">]</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'Not Started'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>wbs</span><span class="s4">:</span><span class="s2"> values</span><span class="s4">[</span><span class="s2">wbsIndex</span><span class="s4">]</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">''</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">};</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>activities</span><span class="s4">.</span><span class="s2">push</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s6"> </span><span class="s4">(</span><span class="s6">activities</span><span class="s4">.</span><span class="s6">length </span><span class="s4">===</span><span class="s6"> </span><span class="s9">0</span><span class="s4">)</span><span class="s6"> </span><span class="s1">throw</span><span class="s6"> </span><span class="s1">new</span><span class="s6"> </span><span class="s3">Error</span><span class="s4">(</span><span class="s2">'Could not parse any valid activity rows from the CSV file.'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> activities</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> parsePDFData </span><span class="s4">=</span><span class="s2"> </span><span class="s1">async</span><span class="s2"> </span><span class="s4">(</span><span class="s2">pdfContent</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s2"> pdf </span><span class="s4">=</span><span class="s2"> </span><span class="s1">await</span><span class="s2"> window</span><span class="s4">.</span><span class="s2">pdfjsLib</span><span class="s4">.</span><span class="s2">getDocument</span><span class="s4">({</span><span class="s2"> data</span><span class="s4">:</span><span class="s2"> pdfContent </span><span class="s4">}).</span><span class="s2">promise</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">let</span><span class="s2"> allText </span><span class="s4">=</span><span class="s2"> </span><span class="s5">''</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">for</span><span class="s2"> </span><span class="s4">(</span><span class="s1">let</span><span class="s2"> i </span><span class="s4">=</span><span class="s2"> </span><span class="s9">1</span><span class="s4">;</span><span class="s2"> i </span><span class="s4">&lt;=</span><span class="s2"> pdf</span><span class="s4">.</span><span class="s2">numPages</span><span class="s4">;</span><span class="s2"> i</span><span class="s4">++)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s1">const</span><span class="s2"> page </span><span class="s4">=</span><span class="s2"> </span><span class="s1">await</span><span class="s2"> pdf</span><span class="s4">.</span><span class="s2">getPage</span><span class="s4">(</span><span class="s2">i</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s1">const</span><span class="s2"> textContent </span><span class="s4">=</span><span class="s2"> </span><span class="s1">await</span><span class="s2"> page</span><span class="s4">.</span><span class="s2">getTextContent</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span>allText </span><span class="s4">+=</span><span class="s2"> textContent</span><span class="s4">.</span><span class="s2">items</span><span class="s4">.</span><span class="s2">map</span><span class="s4">(</span><span class="s2">item </span><span class="s4">=&gt;</span><span class="s2"> item</span><span class="s4">.</span><span class="s2">str</span><span class="s4">).</span><span class="s2">join</span><span class="s4">(</span><span class="s5">' '</span><span class="s4">)</span><span class="s2"> </span><span class="s4">+</span><span class="s2"> </span><span class="s5">'\n'</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s2"> lines </span><span class="s4">=</span><span class="s2"> allText</span><span class="s4">.</span><span class="s2">split</span><span class="s4">(</span><span class="s5">'\n'</span><span class="s4">).</span><span class="s2">filter</span><span class="s4">(</span><span class="s2">line </span><span class="s4">=&gt;</span><span class="s2"> line</span><span class="s4">.</span><span class="s2">trim</span><span class="s4">().</span><span class="s2">length </span><span class="s4">&gt;</span><span class="s2"> </span><span class="s9">5</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s2"> activities </span><span class="s4">=</span><span class="s2"> </span><span class="s4">[];</span></p>
<p class="p8"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s6"> rowRegex </span><span class="s4">=</span><span class="s6"> </span><span class="s2">/^([A-Z0-9]+)\s+([\w\s-]+?)\s+(\d{2}-[A-Za-z]{3}-\d{2})\s+(\d{2}-[A-Za-z]{3}-\d{2})/</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">for</span><span class="s2"> </span><span class="s4">(</span><span class="s1">const</span><span class="s2"> line </span><span class="s1">of</span><span class="s2"> lines</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s1">const</span><span class="s2"> match </span><span class="s4">=</span><span class="s2"> line</span><span class="s4">.</span><span class="s2">match</span><span class="s4">(</span><span class="s2">rowRegex</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">match</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">              </span>activities</span><span class="s4">.</span><span class="s2">push</span><span class="s4">({</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                  </span>id</span><span class="s4">:</span><span class="s2"> match</span><span class="s4">[</span><span class="s9">1</span><span class="s4">]</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">`PDF-ACT-</span><span class="s4">${</span><span class="s2">activities</span><span class="s4">.</span><span class="s2">length </span><span class="s4">+</span><span class="s2"> </span><span class="s9">1</span><span class="s4">}</span><span class="s5">`</span><span class="s4">,</span><span class="s2"> name</span><span class="s4">:</span><span class="s2"> match</span><span class="s4">[</span><span class="s9">2</span><span class="s4">].</span><span class="s2">trim</span><span class="s4">()</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'Unnamed'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                  </span>startDate</span><span class="s4">:</span><span class="s2"> formatDate</span><span class="s4">(</span><span class="s2">match</span><span class="s4">[</span><span class="s9">3</span><span class="s4">]),</span><span class="s2"> finishDate</span><span class="s4">:</span><span class="s2"> formatDate</span><span class="s4">(</span><span class="s2">match</span><span class="s4">[</span><span class="s9">4</span><span class="s4">]),</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                  </span>duration</span><span class="s4">:</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span><span class="s2"> percentComplete</span><span class="s4">:</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span><span class="s2"> totalFloat</span><span class="s4">:</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">,</span><span class="s2"> status</span><span class="s4">:</span><span class="s2"> </span><span class="s5">'Not Started'</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                  </span>wbs</span><span class="s4">:</span><span class="s2"> </span><span class="s5">''</span><span class="s4">,</span><span class="s2"> resourceNames</span><span class="s4">:</span><span class="s2"> </span><span class="s5">''</span><span class="s4">,</span><span class="s2"> predecessors</span><span class="s4">:</span><span class="s2"> </span><span class="s5">''</span><span class="s4">,</span><span class="s2"> successors</span><span class="s4">:</span><span class="s2"> </span><span class="s5">''</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">              </span></span><span class="s4">});</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">}</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s1">if</span><span class="s6"> </span><span class="s4">(</span><span class="s6">activities</span><span class="s4">.</span><span class="s6">length </span><span class="s4">===</span><span class="s6"> </span><span class="s9">0</span><span class="s4">)</span><span class="s6"> </span><span class="s1">throw</span><span class="s6"> </span><span class="s1">new</span><span class="s6"> </span><span class="s3">Error</span><span class="s4">(</span><span class="s2">'Could not automatically extract activity data from PDF.'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">return</span><span class="s2"> activities</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> getElementText </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">parent</span><span class="s4">,</span><span class="s2"> tagName</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> parent</span><span class="s4">.</span><span class="s2">getElementsByTagName</span><span class="s4">(</span><span class="s2">tagName</span><span class="s4">)[</span><span class="s9">0</span><span class="s4">]?.</span><span class="s2">textContent </span><span class="s4">||</span><span class="s2"> </span><span class="s5">""</span><span class="s4">;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> formatDate </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">dateString</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(!</span><span class="s2">dateString</span><span class="s4">)</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> </span><span class="s5">""</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">try</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">const</span><span class="s2"> date </span><span class="s4">=</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Date</span><span class="s4">(</span><span class="s2">dateString</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">return</span><span class="s2"> isNaN</span><span class="s4">(</span><span class="s2">date</span><span class="s4">.</span><span class="s2">getTime</span><span class="s4">())</span><span class="s2"> </span><span class="s4">?</span><span class="s2"> dateString </span><span class="s4">:</span><span class="s2"> date</span><span class="s4">.</span><span class="s2">toISOString</span><span class="s4">().</span><span class="s2">split</span><span class="s4">(</span><span class="s5">"T"</span><span class="s4">)[</span><span class="s9">0</span><span class="s4">];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span><span class="s2"> </span><span class="s1">catch</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> dateString</span><span class="s4">;</span><span class="s2"> </span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> exportStandardCSV </span><span class="s4">=</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">filteredData</span><span class="s4">.</span><span class="s2">length </span><span class="s4">===</span><span class="s2"> </span><span class="s9">0</span><span class="s4">)</span><span class="s2"> </span><span class="s1">return</span><span class="s4">;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s6"> headers </span><span class="s4">=</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'Activity ID'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Activity Name'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Start Date'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Finish Date'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Duration'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'% Complete'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Total Float'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Status'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'WBS'</span><span class="s4">];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> csvRows </span><span class="s4">=</span><span class="s2"> </span><span class="s4">[</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>headers</span><span class="s4">.</span><span class="s2">join</span><span class="s4">(</span><span class="s5">','</span><span class="s4">),</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">...</span><span class="s2">filteredData</span><span class="s4">.</span><span class="s2">map</span><span class="s4">(</span><span class="s2">a </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">[</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s5">`"</span><span class="s4">${</span><span class="s2">a</span><span class="s4">.</span><span class="s2">id</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span><span class="s2"> </span><span class="s5">`"</span><span class="s4">${</span><span class="s2">a</span><span class="s4">.</span><span class="s2">name</span><span class="s4">.</span><span class="s2">replace</span><span class="s4">(</span><span class="s10">/"/</span><span class="s1">g</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'""'</span><span class="s4">)}</span><span class="s5">"`</span><span class="s4">,</span><span class="s2"> </span><span class="s5">`"</span><span class="s4">${</span><span class="s2">a</span><span class="s4">.</span><span class="s2">startDate</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span><span class="s2"> </span><span class="s5">`"</span><span class="s4">${</span><span class="s2">a</span><span class="s4">.</span><span class="s2">finishDate</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s5">`"</span><span class="s4">${</span><span class="s2">a</span><span class="s4">.</span><span class="s2">duration</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span><span class="s2"> </span><span class="s5">`"</span><span class="s4">${</span><span class="s2">a</span><span class="s4">.</span><span class="s2">percentComplete</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span><span class="s2"> </span><span class="s5">`"</span><span class="s4">${</span><span class="s2">a</span><span class="s4">.</span><span class="s2">totalFloat</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span><span class="s2"> </span><span class="s5">`"</span><span class="s4">${</span><span class="s2">a</span><span class="s4">.</span><span class="s2">status</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span><span class="s2"> </span><span class="s5">`"</span><span class="s4">${</span><span class="s2">a</span><span class="s4">.</span><span class="s2">wbs</span><span class="s4">.</span><span class="s2">replace</span><span class="s4">(</span><span class="s10">/"/</span><span class="s1">g</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'""'</span><span class="s4">)}</span><span class="s5">"`</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">].</span><span class="s2">join</span><span class="s4">(</span><span class="s5">','</span><span class="s4">))</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">];</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s6"> blob </span><span class="s4">=</span><span class="s6"> </span><span class="s1">new</span><span class="s6"> </span><span class="s3">Blob</span><span class="s4">([</span><span class="s6">csvRows</span><span class="s4">.</span><span class="s6">join</span><span class="s4">(</span><span class="s2">'\n'</span><span class="s4">)],</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> </span><span class="s1">type</span><span class="s4">:</span><span class="s6"> </span><span class="s2">'text/csv;charset=utf-8;'</span><span class="s6"> </span><span class="s4">});</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> link </span><span class="s4">=</span><span class="s2"> document</span><span class="s4">.</span><span class="s2">createElement</span><span class="s4">(</span><span class="s5">'a'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>link</span><span class="s4">.</span><span class="s2">href </span><span class="s4">=</span><span class="s2"> </span><span class="s3">URL</span><span class="s4">.</span><span class="s2">createObjectURL</span><span class="s4">(</span><span class="s2">blob</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>link</span><span class="s4">.</span><span class="s2">download </span><span class="s4">=</span><span class="s2"> </span><span class="s5">`p6_filtered_schedule_</span><span class="s4">${</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Date</span><span class="s4">().</span><span class="s2">toISOString</span><span class="s4">().</span><span class="s2">split</span><span class="s4">(</span><span class="s5">'T'</span><span class="s4">)[</span><span class="s9">0</span><span class="s4">]}</span><span class="s5">.csv`</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>document</span><span class="s4">.</span><span class="s2">body</span><span class="s4">.</span><span class="s2">appendChild</span><span class="s4">(</span><span class="s2">link</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>link</span><span class="s4">.</span><span class="s2">click</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>document</span><span class="s4">.</span><span class="s2">body</span><span class="s4">.</span><span class="s2">removeChild</span><span class="s4">(</span><span class="s2">link</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">URL</span><span class="s4">.</span><span class="s2">revokeObjectURL</span><span class="s4">(</span><span class="s2">link</span><span class="s4">.</span><span class="s2">href</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> exportDataCentreCSV </span><span class="s4">=</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(!</span><span class="s2">structuredData </span><span class="s4">||</span><span class="s2"> </span><span class="s3">Object</span><span class="s4">.</span><span class="s2">keys</span><span class="s4">(</span><span class="s2">structuredData</span><span class="s4">).</span><span class="s2">length </span><span class="s4">===</span><span class="s2"> </span><span class="s9">0</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">        </span>alert</span><span class="s4">(</span><span class="s2">"No data available to export in the Data Centre view."</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">return</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> csvRows </span><span class="s4">=</span><span class="s2"> </span><span class="s4">[];</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s6"> headers </span><span class="s4">=</span><span class="s6"> </span><span class="s4">[</span><span class="s2">'Location'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Activity ID'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Activity Name'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Start Date'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Finish Date'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Duration'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'% Complete'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'Status'</span><span class="s4">,</span><span class="s6"> </span><span class="s2">'WBS'</span><span class="s4">];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>csvRows</span><span class="s4">.</span><span class="s2">push</span><span class="s4">(</span><span class="s2">headers</span><span class="s4">.</span><span class="s2">join</span><span class="s4">(</span><span class="s5">','</span><span class="s4">));</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> sortedLocationKeys </span><span class="s4">=</span><span class="s2"> </span><span class="s3">Object</span><span class="s4">.</span><span class="s2">keys</span><span class="s4">(</span><span class="s2">structuredData</span><span class="s4">).</span><span class="s2">sort</span><span class="s4">();</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">for</span><span class="s2"> </span><span class="s4">(</span><span class="s1">const</span><span class="s2"> locationKey </span><span class="s1">of</span><span class="s2"> sortedLocationKeys</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> location </span><span class="s4">=</span><span class="s2"> structuredData</span><span class="s4">[</span><span class="s2">locationKey</span><span class="s4">];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> locationName </span><span class="s4">=</span><span class="s2"> location</span><span class="s4">.</span><span class="s2">name</span><span class="s4">;</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">for</span><span class="s2"> </span><span class="s4">(</span><span class="s1">const</span><span class="s2"> activity </span><span class="s1">of</span><span class="s2"> location</span><span class="s4">.</span><span class="s2">activities</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">const</span><span class="s2"> row </span><span class="s4">=</span><span class="s2"> </span><span class="s4">[</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s5">`"</span><span class="s4">${</span><span class="s2">locationName</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s5">`"</span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">id</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s5">`"</span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">name</span><span class="s4">.</span><span class="s2">replace</span><span class="s4">(</span><span class="s10">/"/</span><span class="s1">g</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'""'</span><span class="s4">)}</span><span class="s5">"`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s5">`"</span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">startDate </span><span class="s4">||</span><span class="s2"> </span><span class="s5">''</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s5">`"</span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">finishDate </span><span class="s4">||</span><span class="s2"> </span><span class="s5">''</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s5">`"</span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">duration </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s5">`"</span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">percentComplete </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'0'</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s5">`"</span><span class="s4">${</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">status </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'Not Started'</span><span class="s4">}</span><span class="s5">"`</span><span class="s4">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s5">`"</span><span class="s4">${(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">wbs </span><span class="s4">||</span><span class="s2"> </span><span class="s5">''</span><span class="s4">).</span><span class="s2">replace</span><span class="s4">(</span><span class="s10">/"/</span><span class="s1">g</span><span class="s4">,</span><span class="s2"> </span><span class="s5">'""'</span><span class="s4">)}</span><span class="s5">"`</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>csvRows</span><span class="s4">.</span><span class="s2">push</span><span class="s4">(</span><span class="s2">row</span><span class="s4">.</span><span class="s2">join</span><span class="s4">(</span><span class="s5">','</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s6"> blob </span><span class="s4">=</span><span class="s6"> </span><span class="s1">new</span><span class="s6"> </span><span class="s3">Blob</span><span class="s4">([</span><span class="s6">csvRows</span><span class="s4">.</span><span class="s6">join</span><span class="s4">(</span><span class="s2">'\n'</span><span class="s4">)],</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> </span><span class="s1">type</span><span class="s4">:</span><span class="s6"> </span><span class="s2">'text/csv;charset=utf-8;'</span><span class="s6"> </span><span class="s4">});</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> link </span><span class="s4">=</span><span class="s2"> document</span><span class="s4">.</span><span class="s2">createElement</span><span class="s4">(</span><span class="s5">'a'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>link</span><span class="s4">.</span><span class="s2">href </span><span class="s4">=</span><span class="s2"> </span><span class="s3">URL</span><span class="s4">.</span><span class="s2">createObjectURL</span><span class="s4">(</span><span class="s2">blob</span><span class="s4">);</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span>link</span><span class="s4">.</span><span class="s6">download </span><span class="s4">=</span><span class="s6"> </span><span class="s2">`DataCentre_structured_export_</span><span class="s4">${</span><span class="s1">new</span><span class="s6"> </span><span class="s3">Date</span><span class="s4">().</span><span class="s6">toISOString</span><span class="s4">().</span><span class="s6">split</span><span class="s4">(</span><span class="s2">'T'</span><span class="s4">)[</span><span class="s9">0</span><span class="s4">]}</span><span class="s2">.csv`</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>document</span><span class="s4">.</span><span class="s2">body</span><span class="s4">.</span><span class="s2">appendChild</span><span class="s4">(</span><span class="s2">link</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>link</span><span class="s4">.</span><span class="s2">click</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>document</span><span class="s4">.</span><span class="s2">body</span><span class="s4">.</span><span class="s2">removeChild</span><span class="s4">(</span><span class="s2">link</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s3">URL</span><span class="s4">.</span><span class="s2">revokeObjectURL</span><span class="s4">(</span><span class="s2">link</span><span class="s4">.</span><span class="s2">href</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> resetApp </span><span class="s4">=</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setFile</span><span class="s4">(</span><span class="s1">null</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setParsedData</span><span class="s4">([]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setError</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSuccess</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setShowFilters</span><span class="s4">(</span><span class="s1">false</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setCustomKeywords</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setViewMode</span><span class="s4">(</span><span class="s5">'standard'</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSearchQuery</span><span class="s4">(</span><span class="s5">''</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSelectedActivityIds</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setHiddenActivityIds</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">fileInputRef</span><span class="s4">.</span><span class="s2">current</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>fileInputRef</span><span class="s4">.</span><span class="s2">current</span><span class="s4">.</span><span class="s2">value </span><span class="s4">=</span><span class="s2"> </span><span class="s5">''</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> handleTradeToggle </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">trade</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSelectedTrades</span><span class="s4">(</span><span class="s2">prev </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">({</span><span class="s2"> </span><span class="s4">...</span><span class="s2">prev</span><span class="s4">,</span><span class="s2"> </span><span class="s4">[</span><span class="s2">trade</span><span class="s4">]:</span><span class="s2"> </span><span class="s4">!</span><span class="s2">prev</span><span class="s4">[</span><span class="s2">trade</span><span class="s4">]</span><span class="s2"> </span><span class="s4">}));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> handleSelectAllTrades </span><span class="s4">=</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> allSelected </span><span class="s4">=</span><span class="s2"> </span><span class="s3">Object</span><span class="s4">.</span><span class="s2">values</span><span class="s4">(</span><span class="s2">selectedTrades</span><span class="s4">).</span><span class="s2">every</span><span class="s4">(</span><span class="s3">Boolean</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> newState </span><span class="s4">=</span><span class="s2"> </span><span class="s3">Object</span><span class="s4">.</span><span class="s2">keys</span><span class="s4">(</span><span class="s2">selectedTrades</span><span class="s4">).</span><span class="s2">reduce</span><span class="s4">((</span><span class="s2">acc</span><span class="s4">,</span><span class="s2"> trade</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>acc</span><span class="s4">[</span><span class="s2">trade</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> </span><span class="s4">!</span><span class="s2">allSelected</span><span class="s4">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s1">return</span><span class="s2"> acc</span><span class="s4">;</span></p>
<p class="p6"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">},</span><span class="s6"> </span><span class="s2">{});</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSelectedTrades</span><span class="s4">(</span><span class="s2">newState</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> handleRemoveExcludeKeyword </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">keywordToRemove</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setExcludeKeywords</span><span class="s4">(</span><span class="s2">prev </span><span class="s4">=&gt;</span><span class="s2"> prev</span><span class="s4">.</span><span class="s2">filter</span><span class="s4">(</span><span class="s2">keyword </span><span class="s4">=&gt;</span><span class="s2"> keyword </span><span class="s4">!==</span><span class="s2"> keywordToRemove</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> handleAddExcludeKeyword </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">newKeyword</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> trimmedKeyword </span><span class="s4">=</span><span class="s2"> newKeyword</span><span class="s4">.</span><span class="s2">trim</span><span class="s4">().</span><span class="s2">toLowerCase</span><span class="s4">();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">trimmedKeyword </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">!</span><span class="s2">excludeKeywords</span><span class="s4">.</span><span class="s2">includes</span><span class="s4">(</span><span class="s2">trimmedKeyword</span><span class="s4">))</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>setExcludeKeywords</span><span class="s4">(</span><span class="s2">prev </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">[...</span><span class="s2">prev</span><span class="s4">,</span><span class="s2"> trimmedKeyword</span><span class="s4">]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">  </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> handleSelectAllOnPage </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">e</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> pageIds </span><span class="s4">=</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">(</span><span class="s2">paginatedData</span><span class="s4">.</span><span class="s2">map</span><span class="s4">(</span><span class="s2">a </span><span class="s4">=&gt;</span><span class="s2"> a</span><span class="s4">.</span><span class="s2">id</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> newSelection </span><span class="s4">=</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">(</span><span class="s2">selectedActivityIds</span><span class="s4">);</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">e</span><span class="s4">.</span><span class="s2">target</span><span class="s4">.</span><span class="s2">checked</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>pageIds</span><span class="s4">.</span><span class="s2">forEach</span><span class="s4">(</span><span class="s2">id </span><span class="s4">=&gt;</span><span class="s2"> newSelection</span><span class="s4">.</span><span class="s2">add</span><span class="s4">(</span><span class="s2">id</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span><span class="s2"> </span><span class="s1">else</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>pageIds</span><span class="s4">.</span><span class="s2">forEach</span><span class="s4">(</span><span class="s2">id </span><span class="s4">=&gt;</span><span class="s2"> newSelection</span><span class="s4">.</span><span class="s1">delete</span><span class="s4">(</span><span class="s2">id</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSelectedActivityIds</span><span class="s4">(</span><span class="s2">newSelection</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> handleSelectSingle </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">id</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> newSelection </span><span class="s4">=</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">(</span><span class="s2">selectedActivityIds</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">newSelection</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">id</span><span class="s4">))</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>newSelection</span><span class="s4">.</span><span class="s1">delete</span><span class="s4">(</span><span class="s2">id</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span><span class="s2"> </span><span class="s1">else</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span>newSelection</span><span class="s4">.</span><span class="s2">add</span><span class="s4">(</span><span class="s2">id</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSelectedActivityIds</span><span class="s4">(</span><span class="s2">newSelection</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> handleHideSelected </span><span class="s4">=</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setHiddenActivityIds</span><span class="s4">(</span><span class="s2">prevHidden </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">([...</span><span class="s2">prevHidden</span><span class="s4">,</span><span class="s2"> </span><span class="s4">...</span><span class="s2">selectedActivityIds</span><span class="s4">]));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setSelectedActivityIds</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> handleShowAll </span><span class="s4">=</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>setHiddenActivityIds</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Accordion component for the Data Centre view</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s3">Accordion</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> </span><span class="s4">({</span><span class="s2"> title</span><span class="s4">,</span><span class="s2"> children</span><span class="s4">,</span><span class="s2"> defaultOpen </span><span class="s4">=</span><span class="s2"> </span><span class="s1">false</span><span class="s2"> </span><span class="s4">})</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">isOpen</span><span class="s4">,</span><span class="s2"> setIsOpen</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s2">defaultOpen</span><span class="s4">);</span></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">return</span><span class="s6"> </span><span class="s4">(</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"border rounded-lg mb-2 bg-white"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"w-full flex justify-between items-center p-3 bg-gray-50 hover:bg-gray-100 transition-colors"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">{</span><span class="s2">title</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">&lt;</span><span class="s2">button onClick</span><span class="s4">={()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> setIsOpen</span><span class="s4">(!</span><span class="s2">isOpen</span><span class="s4">)}&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;</span><span class="s3">ChevronDown</span><span class="s6"> className</span><span class="s4">={</span><span class="s2">`transform transition-transform duration-200 </span><span class="s4">${</span><span class="s6">isOpen </span><span class="s4">?</span><span class="s6"> </span><span class="s2">'rotate-180'</span><span class="s6"> </span><span class="s4">:</span><span class="s6"> </span><span class="s2">''</span><span class="s4">}</span><span class="s2">`</span><span class="s4">}</span><span class="s6"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">&lt;/</span><span class="s2">button</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">{</span><span class="s2">isOpen </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"p-4 border-t"</span><span class="s4">&gt;{</span><span class="s2">children</span><span class="s4">}&lt;/</span><span class="s2">div</span><span class="s4">&gt;}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p4"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">// Component to render the structured Data Centre view</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s3">StructuredView</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> </span><span class="s4">({</span><span class="s2"> data</span><span class="s4">,</span><span class="s2"> onExport </span><span class="s4">})</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">selectedItems</span><span class="s4">,</span><span class="s2"> setSelectedItems</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> </span><span class="s4">[</span><span class="s2">hiddenItems</span><span class="s4">,</span><span class="s2"> setHiddenItems</span><span class="s4">]</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> useState</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> handleGroupSelect </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">groupKey</span><span class="s4">,</span><span class="s2"> activities</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> newSelection </span><span class="s4">=</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">(</span><span class="s2">selectedItems</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> allActivityIds </span><span class="s4">=</span><span class="s2"> activities</span><span class="s4">.</span><span class="s2">map</span><span class="s4">(</span><span class="s2">a </span><span class="s4">=&gt;</span><span class="s2"> a</span><span class="s4">.</span><span class="s2">id</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> areAllSelected </span><span class="s4">=</span><span class="s2"> allActivityIds</span><span class="s4">.</span><span class="s2">every</span><span class="s4">(</span><span class="s2">id </span><span class="s4">=&gt;</span><span class="s2"> newSelection</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">id</span><span class="s4">));</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">areAllSelected</span><span class="s4">)</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>allActivityIds</span><span class="s4">.</span><span class="s2">forEach</span><span class="s4">(</span><span class="s2">id </span><span class="s4">=&gt;</span><span class="s2"> newSelection</span><span class="s4">.</span><span class="s1">delete</span><span class="s4">(</span><span class="s2">id</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">}</span><span class="s2"> </span><span class="s1">else</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>allActivityIds</span><span class="s4">.</span><span class="s2">forEach</span><span class="s4">(</span><span class="s2">id </span><span class="s4">=&gt;</span><span class="s2"> newSelection</span><span class="s4">.</span><span class="s2">add</span><span class="s4">(</span><span class="s2">id</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>setSelectedItems</span><span class="s4">(</span><span class="s2">newSelection</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> handleItemSelect </span><span class="s4">=</span><span class="s2"> </span><span class="s4">(</span><span class="s2">id</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> newSelection </span><span class="s4">=</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">(</span><span class="s2">selectedItems</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">newSelection</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">id</span><span class="s4">))</span><span class="s2"> newSelection</span><span class="s4">.</span><span class="s1">delete</span><span class="s4">(</span><span class="s2">id</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">else</span><span class="s2"> newSelection</span><span class="s4">.</span><span class="s2">add</span><span class="s4">(</span><span class="s2">id</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>setSelectedItems</span><span class="s4">(</span><span class="s2">newSelection</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> handleHide </span><span class="s4">=</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>setHiddenItems</span><span class="s4">(</span><span class="s2">prevHidden </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">([...</span><span class="s2">prevHidden</span><span class="s4">,</span><span class="s2"> </span><span class="s4">...</span><span class="s2">selectedItems</span><span class="s4">]));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>setSelectedItems</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> handleShow </span><span class="s4">=</span><span class="s2"> </span><span class="s4">()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> setHiddenItems</span><span class="s4">(</span><span class="s1">new</span><span class="s2"> </span><span class="s3">Set</span><span class="s4">());</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">return</span><span class="s6"> </span><span class="s4">(</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"bg-white rounded-xl shadow-md p-6"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;</span><span class="s6">h2 className</span><span class="s4">=</span><span class="s2">"text-2xl font-bold text-gray-900"</span><span class="s4">&gt;</span><span class="s3">Data</span><span class="s6"> </span><span class="s3">Centre</span><span class="s6"> </span><span class="s3">Structured</span><span class="s6"> </span><span class="s3">View</span><span class="s4">&lt;/</span><span class="s6">h2</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"flex gap-2"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s6">button onClick</span><span class="s4">={</span><span class="s6">handleHide</span><span class="s4">}</span><span class="s6"> disabled</span><span class="s4">={</span><span class="s6">selectedItems</span><span class="s4">.</span><span class="s6">size </span><span class="s4">===</span><span class="s6"> </span><span class="s9">0</span><span class="s4">}</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"flex items-center gap-2 px-4 py-2 bg-yellow-500 text-white font-semibold rounded-lg shadow-sm hover:bg-yellow-600 disabled:bg-gray-300 disabled:cursor-not-allowed"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s3">EyeOff</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"w-5 h-5"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s3">Hide</span><span class="s2"> </span><span class="s3">Selected</span><span class="s2"> </span><span class="s4">({</span><span class="s2">selectedItems</span><span class="s4">.</span><span class="s2">size</span><span class="s4">})</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;/</span><span class="s2">button</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s6">button onClick</span><span class="s4">={</span><span class="s6">handleShow</span><span class="s4">}</span><span class="s6"> disabled</span><span class="s4">={</span><span class="s6">hiddenItems</span><span class="s4">.</span><span class="s6">size </span><span class="s4">===</span><span class="s6"> </span><span class="s9">0</span><span class="s4">}</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg shadow-sm hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s3">Eye</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"w-5 h-5"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s3">Show</span><span class="s2"> </span><span class="s3">All</span><span class="s2"> </span><span class="s4">({</span><span class="s2">hiddenItems</span><span class="s4">.</span><span class="s2">size</span><span class="s4">})</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;/</span><span class="s2">button</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s6">button onClick</span><span class="s4">={</span><span class="s6">onExport</span><span class="s4">}</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"bg-green-600 hover:bg-green-700 text-white font-bold px-6 py-2 rounded-lg transition-all duration-300 flex items-center gap-2 shadow-sm hover:shadow-md w-full sm:w-auto"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s3">Download</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"w-5 h-5"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s3">Export</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;/</span><span class="s2">button</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">{</span><span class="s3">Object</span><span class="s4">.</span><span class="s2">keys</span><span class="s4">(</span><span class="s2">data</span><span class="s4">).</span><span class="s2">length </span><span class="s4">&gt;</span><span class="s2"> </span><span class="s9">0</span><span class="s2"> </span><span class="s4">?</span><span class="s2"> </span><span class="s3">Object</span><span class="s4">.</span><span class="s2">keys</span><span class="s4">(</span><span class="s2">data</span><span class="s4">).</span><span class="s2">sort</span><span class="s4">().</span><span class="s2">map</span><span class="s4">(</span><span class="s2">groupKey </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s1">const</span><span class="s2"> group </span><span class="s4">=</span><span class="s2"> data</span><span class="s4">[</span><span class="s2">groupKey</span><span class="s4">];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s1">const</span><span class="s2"> visibleActivities </span><span class="s4">=</span><span class="s2"> group</span><span class="s4">.</span><span class="s2">activities</span><span class="s4">.</span><span class="s2">filter</span><span class="s4">(</span><span class="s2">a </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">!</span><span class="s2">hiddenItems</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">a</span><span class="s4">.</span><span class="s2">id</span><span class="s4">));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">hiddenItems</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">groupKey</span><span class="s4">)</span><span class="s2"> </span><span class="s4">||</span><span class="s2"> visibleActivities</span><span class="s4">.</span><span class="s2">length </span><span class="s4">===</span><span class="s2"> </span><span class="s9">0</span><span class="s4">)</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> </span><span class="s1">null</span><span class="s4">;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s1">const</span><span class="s2"> allInGroupSelected </span><span class="s4">=</span><span class="s2"> visibleActivities</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt;</span><span class="s2"> </span><span class="s9">0</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> visibleActivities</span><span class="s4">.</span><span class="s2">every</span><span class="s4">(</span><span class="s2">a </span><span class="s4">=&gt;</span><span class="s2"> selectedItems</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">a</span><span class="s4">.</span><span class="s2">id</span><span class="s4">));</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s1">return</span><span class="s2"> </span><span class="s4">(</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s3">Accordion</span><span class="s2"> key</span><span class="s4">={</span><span class="s2">groupKey</span><span class="s4">}</span><span class="s2"> title</span><span class="s4">={</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"flex items-center w-full"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s2">input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s1">type</span><span class="s4">=</span><span class="s5">"checkbox"</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                                </span>className</span><span class="s4">=</span><span class="s2">"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span>checked</span><span class="s4">={</span><span class="s2">allInGroupSelected</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span>onChange</span><span class="s4">={()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> handleGroupSelect</span><span class="s4">(</span><span class="s2">groupKey</span><span class="s4">,</span><span class="s2"> visibleActivities</span><span class="s4">)}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span>onClick</span><span class="s4">={(</span><span class="s2">e</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> e</span><span class="s4">.</span><span class="s2">stopPropagation</span><span class="s4">()}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span>/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">{</span><span class="s2">group</span><span class="s4">.</span><span class="s2">name</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">}</span><span class="s2"> defaultOpen</span><span class="s4">={</span><span class="s1">true</span><span class="s4">}&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s2">ul className</span><span class="s4">=</span><span class="s5">"space-y-2"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">{</span><span class="s2">visibleActivities</span><span class="s4">.</span><span class="s2">map</span><span class="s4">(</span><span class="s2">act </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">(</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">li key</span><span class="s4">={</span><span class="s2">act</span><span class="s4">.</span><span class="s2">id</span><span class="s4">}</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"flex items-center text-sm"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s2">input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                        </span></span><span class="s1">type</span><span class="s4">=</span><span class="s5">"checkbox"</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                                        </span>className</span><span class="s4">=</span><span class="s2">"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3"</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                        </span>checked</span><span class="s4">={</span><span class="s2">selectedItems</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">act</span><span class="s4">.</span><span class="s2">id</span><span class="s4">)}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                        </span>onChange</span><span class="s4">={()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> handleItemSelect</span><span class="s4">(</span><span class="s2">act</span><span class="s4">.</span><span class="s2">id</span><span class="s4">)}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span>/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s2">span className</span><span class="s4">=</span><span class="s5">"text-gray-800"</span><span class="s4">&gt;{</span><span class="s2">act</span><span class="s4">.</span><span class="s2">name</span><span class="s4">}</span><span class="s2"> </span><span class="s4">({</span><span class="s2">act</span><span class="s4">.</span><span class="s2">startDate </span><span class="s4">||</span><span class="s2"> </span><span class="s5">'No Date'</span><span class="s4">})&lt;/</span><span class="s2">span</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;/</span><span class="s2">li</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">))}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;/</span><span class="s2">ul</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;/</span><span class="s3">Accordion</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">)</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">})</span><span class="s2"> </span><span class="s4">:</span><span class="s2"> </span><span class="s4">&lt;</span><span class="s2">p className</span><span class="s4">=</span><span class="s5">"text-center text-gray-500 py-8"</span><span class="s4">&gt;</span><span class="s3">No</span><span class="s2"> activities matched the </span><span class="s3">Data</span><span class="s2"> </span><span class="s3">Centre</span><span class="s2"> structure</span><span class="s4">.&lt;/</span><span class="s2">p</span><span class="s4">&gt;}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> </span><span class="s3">Pagination</span><span class="s2"> </span><span class="s4">=</span><span class="s2"> </span><span class="s4">({</span><span class="s2"> totalItems</span><span class="s4">,</span><span class="s2"> itemsPerPage</span><span class="s4">,</span><span class="s2"> currentPage</span><span class="s4">,</span><span class="s2"> onPageChange </span><span class="s4">})</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> totalPages </span><span class="s4">=</span><span class="s2"> </span><span class="s3">Math</span><span class="s4">.</span><span class="s2">ceil</span><span class="s4">(</span><span class="s2">totalItems </span><span class="s4">/</span><span class="s2"> itemsPerPage</span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> </span><span class="s4">(</span><span class="s2">totalPages </span><span class="s4">&lt;=</span><span class="s2"> </span><span class="s9">1</span><span class="s4">)</span><span class="s2"> </span><span class="s1">return</span><span class="s2"> </span><span class="s1">null</span><span class="s4">;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s2">return</span><span class="s6"> </span><span class="s4">(</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"flex justify-center items-center gap-2 mt-4"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;</span><span class="s2">button onClick</span><span class="s4">={()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> onPageChange</span><span class="s4">(</span><span class="s2">currentPage </span><span class="s4">-</span><span class="s2"> </span><span class="s9">1</span><span class="s4">)}</span><span class="s2"> disabled</span><span class="s4">={</span><span class="s2">currentPage </span><span class="s4">===</span><span class="s2"> </span><span class="s9">1</span><span class="s4">}</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"px-3 py-1 border rounded-md bg-white disabled:opacity-50 hover:bg-gray-50"</span><span class="s4">&gt;</span><span class="s3">Previous</span><span class="s4">&lt;/</span><span class="s2">button</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;</span><span class="s2">span className</span><span class="s4">=</span><span class="s5">"text-sm text-gray-700"</span><span class="s4">&gt;</span><span class="s3">Page</span><span class="s2"> </span><span class="s4">{</span><span class="s2">currentPage</span><span class="s4">}</span><span class="s2"> </span><span class="s1">of</span><span class="s2"> </span><span class="s4">{</span><span class="s2">totalPages</span><span class="s4">}&lt;/</span><span class="s2">span</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;</span><span class="s2">button onClick</span><span class="s4">={()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> onPageChange</span><span class="s4">(</span><span class="s2">currentPage </span><span class="s4">+</span><span class="s2"> </span><span class="s9">1</span><span class="s4">)}</span><span class="s2"> disabled</span><span class="s4">={</span><span class="s2">currentPage </span><span class="s4">===</span><span class="s2"> totalPages</span><span class="s4">}</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"px-3 py-1 border rounded-md bg-white disabled:opacity-50 hover:bg-gray-50"</span><span class="s4">&gt;</span><span class="s3">Next</span><span class="s4">&lt;/</span><span class="s2">button</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">};</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p5"><span class="s6"><span class="Apple-converted-space">  </span></span><span class="s2">return</span><span class="s6"> </span><span class="s4">(</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">    </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"min-h-screen bg-gray-50 font-sans p-4 sm:p-6 lg:p-8"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"max-w-7xl mx-auto"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;</span><span class="s6">header className</span><span class="s4">=</span><span class="s2">"bg-white rounded-xl shadow-md p-6 mb-6"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">          </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"flex flex-col sm:flex-row items-center gap-4"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"p-3 bg-blue-600 rounded-lg text-white"</span><span class="s6">&gt;&lt;</span><span class="s3">Calendar</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"w-8 h-8"</span><span class="s6"> /&gt;&lt;/div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s6">h1 className</span><span class="s4">=</span><span class="s2">"text-2xl sm:text-3xl font-bold text-gray-900 text-center sm:text-left"</span><span class="s4">&gt;</span><span class="s3">P6</span><span class="s6"> </span><span class="s3">Schedule</span><span class="s6"> to </span><span class="s3">CSV</span><span class="s6"> </span><span class="s3">Converter</span><span class="s4">&lt;/</span><span class="s6">h1</span><span class="s4">&gt;</span></p>
<p class="p2"><span class="s6"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s6">p className</span><span class="s4">=</span><span class="s5">"text-gray-600 text-center sm:text-left"</span><span class="s4">&gt;</span><span class="s2">Upload</span><span class="s4">,</span><span class="s6"> </span><span class="s2">Filter</span><span class="s6"> by </span><span class="s2">Construction</span><span class="s6"> </span><span class="s2">Trades</span><span class="s4">,</span><span class="s6"> and </span><span class="s2">Export</span><span class="s6"> </span><span class="s2">P6</span><span class="s6"> </span><span class="s2">Data</span><span class="s4">&lt;/</span><span class="s6">p</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;/</span><span class="s2">header</span><span class="s4">&gt;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;</span><span class="s2">main</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">          </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"bg-white rounded-xl shadow-md p-6 mb-6"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"border-2 border-dashed border-gray-300 rounded-lg p-6 sm:p-8 text-center"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s3">Upload</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"mx-auto mb-4 text-blue-500 w-12 h-12"</span><span class="s6"> /&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s6">h2 className</span><span class="s4">=</span><span class="s2">"text-xl font-semibold text-gray-800 mb-2"</span><span class="s4">&gt;</span><span class="s3">Upload</span><span class="s6"> </span><span class="s3">Your</span><span class="s6"> </span><span class="s3">P6</span><span class="s6"> </span><span class="s3">Schedule</span><span class="s6"> </span><span class="s3">File</span><span class="s4">&lt;/</span><span class="s6">h2</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s2">p className</span><span class="s4">=</span><span class="s5">"text-gray-500 mb-6 max-w-md mx-auto"</span><span class="s4">&gt;</span><span class="s3">Supports</span><span class="s2"> </span><span class="s3">XML</span><span class="s4">,</span><span class="s2"> </span><span class="s3">XER</span><span class="s4">,</span><span class="s2"> </span><span class="s3">CSV</span><span class="s4">,</span><span class="s2"> and </span><span class="s3">PDF</span><span class="s2"> files</span><span class="s4">.&lt;/</span><span class="s2">p</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s2">input ref</span><span class="s4">={</span><span class="s2">fileInputRef</span><span class="s4">}</span><span class="s2"> </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"file"</span><span class="s2"> accept</span><span class="s4">=</span><span class="s5">".xml,.xer,.csv,.pdf"</span><span class="s2"> onChange</span><span class="s4">={</span><span class="s2">handleFileUpload</span><span class="s4">}</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"hidden"</span><span class="s2"> id</span><span class="s4">=</span><span class="s5">"file-upload"</span><span class="s2"> /&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"flex flex-col sm:flex-row gap-3 justify-center"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;</span><span class="s6">label htmlFor</span><span class="s4">=</span><span class="s2">"file-upload"</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"bg-blue-600 hover:bg-blue-700 text-white font-bold px-6 py-3 rounded-lg cursor-pointer transition-all duration-300 flex items-center justify-center gap-2 shadow-sm hover:shadow-md"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                  </span></span><span class="s4">&lt;</span><span class="s3">FileText</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"w-5 h-5"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                  </span></span><span class="s4">&lt;</span><span class="s2">span</span><span class="s4">&gt;{</span><span class="s2">file </span><span class="s4">?</span><span class="s2"> </span><span class="s5">'Choose Another File'</span><span class="s2"> </span><span class="s4">:</span><span class="s2"> </span><span class="s5">'Choose File'</span><span class="s4">}&lt;/</span><span class="s2">span</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;/</span><span class="s2">label</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                </span></span><span class="s4">{</span><span class="s6">file </span><span class="s4">&amp;&amp;</span><span class="s6"> </span><span class="s4">&lt;</span><span class="s6">button onClick</span><span class="s4">={</span><span class="s6">resetApp</span><span class="s4">}</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"bg-gray-500 hover:bg-gray-600 text-white font-bold px-6 py-3 rounded-lg transition-all duration-300 flex items-center justify-center gap-2 shadow-sm hover:shadow-md"</span><span class="s4">&gt;</span><span class="s3">Reset</span><span class="s4">&lt;/</span><span class="s6">button</span><span class="s4">&gt;}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">              </span></span><span class="s4">{</span><span class="s2">file </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">&lt;</span><span class="s2">p className</span><span class="s4">=</span><span class="s5">"mt-4 text-sm text-gray-600"</span><span class="s4">&gt;</span><span class="s3">Selected</span><span class="s4">:</span><span class="s2"> </span><span class="s4">&lt;</span><span class="s2">strong</span><span class="s4">&gt;{</span><span class="s2">file</span><span class="s4">.</span><span class="s2">name</span><span class="s4">}&lt;/</span><span class="s2">strong&gt;&lt;/p</span><span class="s4">&gt;}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">            </span></span><span class="s4">{</span><span class="s6">isProcessing </span><span class="s4">&amp;&amp;</span><span class="s6"> </span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"bg-blue-50 border-l-4 border-blue-400 text-blue-700 p-4 mt-6 rounded-r-lg flex items-center gap-3"</span><span class="s6">&gt;&lt;</span><span class="s3">Clock</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"w-5 h-5 animate-spin"</span><span class="s6"> /&gt;&lt;span</span><span class="s4">&gt;</span><span class="s3">Processing</span><span class="s6"> file</span><span class="s4">...&lt;/</span><span class="s6">span&gt;&lt;/div</span><span class="s4">&gt;}</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">            </span></span><span class="s4">{</span><span class="s6">error </span><span class="s4">&amp;&amp;</span><span class="s6"> </span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"bg-red-50 border-l-4 border-red-400 text-red-700 p-4 mt-6 rounded-r-lg flex items-center gap-3"</span><span class="s6">&gt;&lt;</span><span class="s3">AlertCircle</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"w-5 h-5"</span><span class="s6"> /&gt;&lt;span</span><span class="s4">&gt;{</span><span class="s6">error</span><span class="s4">}&lt;/</span><span class="s6">span&gt;&lt;/div</span><span class="s4">&gt;}</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">            </span></span><span class="s4">{</span><span class="s6">success </span><span class="s4">&amp;&amp;</span><span class="s6"> </span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"bg-green-50 border-l-4 border-green-400 text-green-700 p-4 mt-6 rounded-r-lg flex items-center gap-3"</span><span class="s6">&gt;&lt;</span><span class="s3">CheckCircle</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"w-5 h-5"</span><span class="s6"> /&gt;&lt;span</span><span class="s4">&gt;{</span><span class="s6">success</span><span class="s4">}&lt;/</span><span class="s6">span&gt;&lt;/div</span><span class="s4">&gt;}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">{</span><span class="s2">parsedData</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt;</span><span class="s2"> </span><span class="s9">0</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">(</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"flex justify-center gap-4 mb-6"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s6">button onClick</span><span class="s4">={()</span><span class="s6"> </span><span class="s4">=&gt;</span><span class="s6"> setViewMode</span><span class="s4">(</span><span class="s2">'standard'</span><span class="s4">)}</span><span class="s6"> className</span><span class="s4">={</span><span class="s2">`px-6 py-2 rounded-lg font-semibold transition </span><span class="s4">${</span><span class="s6">viewMode </span><span class="s4">===</span><span class="s6"> </span><span class="s2">'standard'</span><span class="s6"> </span><span class="s4">?</span><span class="s6"> </span><span class="s2">'bg-blue-600 text-white shadow'</span><span class="s6"> </span><span class="s4">:</span><span class="s6"> </span><span class="s2">'bg-white text-gray-700 hover:bg-gray-100'</span><span class="s4">}</span><span class="s2">`</span><span class="s4">}&gt;</span><span class="s3">Standard</span><span class="s6"> </span><span class="s3">View</span><span class="s4">&lt;/</span><span class="s6">button</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s6">button onClick</span><span class="s4">={()</span><span class="s6"> </span><span class="s4">=&gt;</span><span class="s6"> setViewMode</span><span class="s4">(</span><span class="s2">'dataCentre'</span><span class="s4">)}</span><span class="s6"> className</span><span class="s4">={</span><span class="s2">`px-6 py-2 rounded-lg font-semibold transition </span><span class="s4">${</span><span class="s6">viewMode </span><span class="s4">===</span><span class="s6"> </span><span class="s2">'dataCentre'</span><span class="s6"> </span><span class="s4">?</span><span class="s6"> </span><span class="s2">'bg-blue-600 text-white shadow'</span><span class="s6"> </span><span class="s4">:</span><span class="s6"> </span><span class="s2">'bg-white text-gray-700 hover:bg-gray-100'</span><span class="s4">}</span><span class="s2">`</span><span class="s4">}&gt;</span><span class="s3">Data</span><span class="s6"> </span><span class="s3">Centre</span><span class="s6"> </span><span class="s3">View</span><span class="s4">&lt;/</span><span class="s6">button</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">)}</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">{</span><span class="s2">viewMode </span><span class="s4">===</span><span class="s2"> </span><span class="s5">'standard'</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> parsedData</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt;</span><span class="s2"> </span><span class="s9">0</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">(</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>&lt;&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"bg-white rounded-xl shadow-md p-6 mb-6"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"flex items-center justify-between mb-4 cursor-pointer"</span><span class="s2"> onClick</span><span class="s4">={()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> setShowFilters</span><span class="s4">(!</span><span class="s2">showFilters</span><span class="s4">)}&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"flex items-center gap-3"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s3">Filter</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"text-blue-600 w-6 h-6"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s2">h2 className</span><span class="s4">=</span><span class="s5">"text-xl font-bold text-gray-900"</span><span class="s4">&gt;</span><span class="s3">Filter</span><span class="s2"> </span><span class="s3">Construction</span><span class="s2"> </span><span class="s3">Trades</span><span class="s4">&lt;/</span><span class="s2">h2</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s2">p className</span><span class="s4">=</span><span class="s5">"text-gray-600"</span><span class="s4">&gt;{</span><span class="s2">filteredData</span><span class="s4">.</span><span class="s2">length</span><span class="s4">}</span><span class="s2"> </span><span class="s1">of</span><span class="s2"> </span><span class="s4">{</span><span class="s2">parsedData</span><span class="s4">.</span><span class="s2">length</span><span class="s4">}</span><span class="s2"> activities match</span><span class="s4">&lt;/</span><span class="s2">p</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s6">button className</span><span class="s4">=</span><span class="s2">"text-blue-600 hover:text-blue-800 font-semibold"</span><span class="s4">&gt;{</span><span class="s6">showFilters </span><span class="s4">?</span><span class="s6"> </span><span class="s2">'Hide'</span><span class="s6"> </span><span class="s4">:</span><span class="s6"> </span><span class="s2">'Show'</span><span class="s4">}&lt;/</span><span class="s6">button</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">{</span><span class="s2">showFilters </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">(</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"pt-4 border-t border-gray-200 mt-4 space-y-6"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"flex items-center justify-between mb-3"</span><span class="s2">&gt;&lt;h3 className</span><span class="s4">=</span><span class="s5">"font-semibold text-gray-800"</span><span class="s4">&gt;</span><span class="s3">Trade</span><span class="s2"> </span><span class="s3">Categories</span><span class="s4">&lt;/</span><span class="s2">h3&gt;&lt;button onClick</span><span class="s4">={</span><span class="s2">handleSelectAllTrades</span><span class="s4">}</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"text-sm font-medium text-blue-600 hover:underline"</span><span class="s4">&gt;{</span><span class="s3">Object</span><span class="s4">.</span><span class="s2">values</span><span class="s4">(</span><span class="s2">selectedTrades</span><span class="s4">).</span><span class="s2">every</span><span class="s4">(</span><span class="s3">Boolean</span><span class="s4">)</span><span class="s2"> </span><span class="s4">?</span><span class="s2"> </span><span class="s5">'Deselect All'</span><span class="s2"> </span><span class="s4">:</span><span class="s2"> </span><span class="s5">'Select All'</span><span class="s4">}&lt;/</span><span class="s2">button&gt;&lt;/div</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">{</span><span class="s3">Object</span><span class="s4">.</span><span class="s2">keys</span><span class="s4">(</span><span class="s2">tradeKeywords</span><span class="s4">).</span><span class="s2">map</span><span class="s4">((</span><span class="s2">trade</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">(</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s6">label key</span><span class="s4">={</span><span class="s6">trade</span><span class="s4">}</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"flex items-center space-x-2 cursor-pointer p-2 rounded-lg hover:bg-gray-100"</span><span class="s6">&gt;&lt;input </span><span class="s1">type</span><span class="s4">=</span><span class="s2">"checkbox"</span><span class="s6"> checked</span><span class="s4">={</span><span class="s6">selectedTrades</span><span class="s4">[</span><span class="s6">trade</span><span class="s4">]}</span><span class="s6"> onChange</span><span class="s4">={()</span><span class="s6"> </span><span class="s4">=&gt;</span><span class="s6"> handleTradeToggle</span><span class="s4">(</span><span class="s6">trade</span><span class="s4">)}</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"</span><span class="s6"> /&gt;&lt;span className</span><span class="s4">=</span><span class="s2">"text-sm text-gray-700 capitalize"</span><span class="s4">&gt;{</span><span class="s6">trade</span><span class="s4">.</span><span class="s6">replace</span><span class="s4">(</span><span class="s10">/_/</span><span class="s1">g</span><span class="s4">,</span><span class="s6"> </span><span class="s2">' '</span><span class="s4">)}&lt;/</span><span class="s6">span&gt;&lt;/label</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">))}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"flex items-center justify-between mb-2"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">h3 className</span><span class="s4">=</span><span class="s5">"font-semibold text-gray-800"</span><span class="s4">&gt;</span><span class="s3">Additional</span><span class="s2"> </span><span class="s3">Keywords</span><span class="s2"> to </span><span class="s3">Include</span><span class="s4">&lt;/</span><span class="s2">h3</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">button onClick</span><span class="s4">={()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> setCustomKeywords</span><span class="s4">(</span><span class="s5">''</span><span class="s4">)}</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"text-sm font-medium text-blue-600 hover:underline"</span><span class="s4">&gt;</span><span class="s3">Clear</span><span class="s4">&lt;/</span><span class="s2">button</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s6">input </span><span class="s1">type</span><span class="s4">=</span><span class="s2">"text"</span><span class="s6"> value</span><span class="s4">={</span><span class="s6">customKeywords</span><span class="s4">}</span><span class="s6"> onChange</span><span class="s4">={(</span><span class="s6">e</span><span class="s4">)</span><span class="s6"> </span><span class="s4">=&gt;</span><span class="s6"> setCustomKeywords</span><span class="s4">(</span><span class="s6">e</span><span class="s4">.</span><span class="s6">target</span><span class="s4">.</span><span class="s6">value</span><span class="s4">)}</span><span class="s6"> placeholder</span><span class="s4">=</span><span class="s2">"e.g., demolition, site work"</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"</span><span class="s6"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"flex items-center justify-between mb-2"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">h3 className</span><span class="s4">=</span><span class="s5">"font-semibold text-gray-800"</span><span class="s4">&gt;</span><span class="s3">Keywords</span><span class="s2"> to </span><span class="s3">Exclude</span><span class="s4">&lt;/</span><span class="s2">h3</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">button onClick</span><span class="s4">={()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> setExcludeKeywords</span><span class="s4">([])}</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"text-sm font-medium text-blue-600 hover:underline"</span><span class="s4">&gt;</span><span class="s3">Clear</span><span class="s2"> </span><span class="s3">All</span><span class="s4">&lt;/</span><span class="s2">button</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"flex flex-wrap gap-2 mb-3"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">{</span><span class="s2">excludeKeywords</span><span class="s4">.</span><span class="s2">map</span><span class="s4">((</span><span class="s2">keyword</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">(&lt;</span><span class="s2">span key</span><span class="s4">={</span><span class="s2">keyword</span><span class="s4">}</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"bg-red-100 text-red-800 text-xs font-medium px-2.5 py-1 rounded-full flex items-center"</span><span class="s4">&gt;{</span><span class="s2">keyword</span><span class="s4">}&lt;</span><span class="s2">button onClick</span><span class="s4">={()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> handleRemoveExcludeKeyword</span><span class="s4">(</span><span class="s2">keyword</span><span class="s4">)}</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"ml-1.5 text-red-500 hover:text-red-700"</span><span class="s2">&gt;&lt;</span><span class="s3">X</span><span class="s2"> size</span><span class="s4">={</span><span class="s9">12</span><span class="s4">}</span><span class="s2"> /&gt;&lt;/button&gt;&lt;/span</span><span class="s4">&gt;))}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s6">form onSubmit</span><span class="s4">={(</span><span class="s6">e</span><span class="s4">)</span><span class="s6"> </span><span class="s4">=&gt;</span><span class="s6"> </span><span class="s4">{</span><span class="s6"> e</span><span class="s4">.</span><span class="s6">preventDefault</span><span class="s4">();</span><span class="s6"> handleAddExcludeKeyword</span><span class="s4">(</span><span class="s6">e</span><span class="s4">.</span><span class="s6">currentTarget</span><span class="s4">.</span><span class="s6">keyword</span><span class="s4">.</span><span class="s6">value</span><span class="s4">);</span><span class="s6"> e</span><span class="s4">.</span><span class="s6">currentTarget</span><span class="s4">.</span><span class="s6">keyword</span><span class="s4">.</span><span class="s6">value </span><span class="s4">=</span><span class="s6"> </span><span class="s2">''</span><span class="s4">;</span><span class="s6"> </span><span class="s4">}}</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"flex gap-2"</span><span class="s6">&gt;&lt;input name</span><span class="s4">=</span><span class="s2">"keyword"</span><span class="s6"> </span><span class="s1">type</span><span class="s4">=</span><span class="s2">"text"</span><span class="s6"> placeholder</span><span class="s4">=</span><span class="s2">"Add keyword to exclude"</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"</span><span class="s6"> /&gt;&lt;button </span><span class="s1">type</span><span class="s4">=</span><span class="s2">"submit"</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"bg-red-600 hover:bg-red-700 text-white font-semibold px-4 py-2 rounded-md shadow-sm"</span><span class="s4">&gt;</span><span class="s3">Add</span><span class="s4">&lt;/</span><span class="s6">button&gt;&lt;/form</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">)}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"bg-white rounded-xl shadow-md p-6"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s2">h2 className</span><span class="s4">=</span><span class="s5">"text-2xl font-bold text-gray-900"</span><span class="s4">&gt;</span><span class="s3">Filtered</span><span class="s2"> </span><span class="s3">Schedule</span><span class="s2"> </span><span class="s3">Preview</span><span class="s4">&lt;/</span><span class="s2">h2</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s2">p className</span><span class="s4">=</span><span class="s5">"text-gray-600"</span><span class="s4">&gt;{</span><span class="s2">displayData</span><span class="s4">.</span><span class="s2">length</span><span class="s4">}</span><span class="s2"> </span><span class="s1">of</span><span class="s2"> </span><span class="s4">{</span><span class="s2">filteredData</span><span class="s4">.</span><span class="s2">length</span><span class="s4">}</span><span class="s2"> activities showing</span><span class="s4">&lt;/</span><span class="s2">p</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s6">button onClick</span><span class="s4">={</span><span class="s6">exportStandardCSV</span><span class="s4">}</span><span class="s6"> disabled</span><span class="s4">={</span><span class="s6">filteredData</span><span class="s4">.</span><span class="s6">length </span><span class="s4">===</span><span class="s6"> </span><span class="s9">0</span><span class="s4">}</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"bg-green-600 hover:bg-green-700 text-white font-bold px-6 py-3 rounded-lg transition-all duration-300 flex items-center gap-2 shadow-sm hover:shadow-md w-full sm:w-auto disabled:bg-gray-400 disabled:cursor-not-allowed"</span><span class="s6">&gt;&lt;</span><span class="s3">Download</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"w-5 h-5"</span><span class="s6"> /&gt;</span><span class="s3">Export</span><span class="s6"> </span><span class="s3">Filtered</span><span class="s6"> </span><span class="s3">CSV</span><span class="s4">&lt;/</span><span class="s6">button</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"flex flex-col sm:flex-row gap-4 mb-4"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"relative flex-grow"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s3">Search</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"</span><span class="s6"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s2">input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s1">type</span><span class="s4">=</span><span class="s5">"text"</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span>placeholder</span><span class="s4">=</span><span class="s5">"Search by ID, Name, or WBS..."</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span>value</span><span class="s4">={</span><span class="s2">searchQuery</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span>onChange</span><span class="s4">={(</span><span class="s2">e</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">{</span><span class="s2"> setSearchQuery</span><span class="s4">(</span><span class="s2">e</span><span class="s4">.</span><span class="s2">target</span><span class="s4">.</span><span class="s2">value</span><span class="s4">);</span><span class="s2"> setCurrentPage</span><span class="s4">(</span><span class="s9">1</span><span class="s4">);</span><span class="s2"> </span><span class="s4">}}</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                            </span>className</span><span class="s4">=</span><span class="s2">"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s2">div className</span><span class="s4">=</span><span class="s5">"flex gap-2"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s6">button onClick</span><span class="s4">={</span><span class="s6">handleHideSelected</span><span class="s4">}</span><span class="s6"> disabled</span><span class="s4">={</span><span class="s6">selectedActivityIds</span><span class="s4">.</span><span class="s6">size </span><span class="s4">===</span><span class="s6"> </span><span class="s9">0</span><span class="s4">}</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"flex items-center gap-2 px-4 py-2 bg-yellow-500 text-white font-semibold rounded-lg shadow-sm hover:bg-yellow-600 disabled:bg-gray-300 disabled:cursor-not-allowed"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s3">EyeOff</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"w-5 h-5"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s3">Hide</span><span class="s2"> </span><span class="s3">Selected</span><span class="s2"> </span><span class="s4">({</span><span class="s2">selectedActivityIds</span><span class="s4">.</span><span class="s2">size</span><span class="s4">})</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;/</span><span class="s2">button</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s6">button onClick</span><span class="s4">={</span><span class="s6">handleShowAll</span><span class="s4">}</span><span class="s6"> disabled</span><span class="s4">={</span><span class="s6">hiddenActivityIds</span><span class="s4">.</span><span class="s6">size </span><span class="s4">===</span><span class="s6"> </span><span class="s9">0</span><span class="s4">}</span><span class="s6"> className</span><span class="s4">=</span><span class="s2">"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white font-semibold rounded-lg shadow-sm hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s3">Eye</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"w-5 h-5"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s3">Show</span><span class="s2"> </span><span class="s3">All</span><span class="s2"> </span><span class="s4">({</span><span class="s2">hiddenActivityIds</span><span class="s4">.</span><span class="s2">size</span><span class="s4">})</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;/</span><span class="s2">button</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;</span><span class="s6">div className</span><span class="s4">=</span><span class="s2">"overflow-x-auto rounded-lg border border-gray-200"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;</span><span class="s6">table className</span><span class="s4">=</span><span class="s2">"w-full text-sm text-left text-gray-500"</span><span class="s4">&gt;</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s6">thead className</span><span class="s4">=</span><span class="s2">"bg-gray-50 text-xs text-gray-700 uppercase"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;</span><span class="s2">tr</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">th scope</span><span class="s4">=</span><span class="s5">"col"</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"p-4"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s2">input </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"checkbox"</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                                        </span>className</span><span class="s4">=</span><span class="s2">"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                        </span>onChange</span><span class="s4">={</span><span class="s2">handleSelectAllOnPage</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                        </span>checked</span><span class="s4">={</span><span class="s2">paginatedData</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt;</span><span class="s2"> </span><span class="s9">0</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> paginatedData</span><span class="s4">.</span><span class="s2">every</span><span class="s4">(</span><span class="s2">a </span><span class="s4">=&gt;</span><span class="s2"> selectedActivityIds</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">a</span><span class="s4">.</span><span class="s2">id</span><span class="s4">))}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span>/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;/</span><span class="s2">th</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">th scope</span><span class="s4">=</span><span class="s5">"col"</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s4">&gt;</span><span class="s3">ID</span><span class="s4">&lt;/</span><span class="s2">th</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">th scope</span><span class="s4">=</span><span class="s5">"col"</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s4">&gt;</span><span class="s3">Activity</span><span class="s2"> </span><span class="s3">Name</span><span class="s4">&lt;/</span><span class="s2">th</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">th scope</span><span class="s4">=</span><span class="s5">"col"</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s4">&gt;</span><span class="s3">Start</span><span class="s4">&lt;/</span><span class="s2">th</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">th scope</span><span class="s4">=</span><span class="s5">"col"</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s4">&gt;</span><span class="s3">Finish</span><span class="s4">&lt;/</span><span class="s2">th</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">th scope</span><span class="s4">=</span><span class="s5">"col"</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s2">&gt;% </span><span class="s3">Comp</span><span class="s4">&lt;/</span><span class="s2">th</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">th scope</span><span class="s4">=</span><span class="s5">"col"</span><span class="s2"> className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s4">&gt;</span><span class="s3">Status</span><span class="s4">&lt;/</span><span class="s2">th</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">&lt;/</span><span class="s2">tr</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;/</span><span class="s2">thead</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;</span><span class="s2">tbody</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">{</span><span class="s2">paginatedData</span><span class="s4">.</span><span class="s2">map</span><span class="s4">((</span><span class="s2">activity</span><span class="s4">)</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> </span><span class="s4">(</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;</span><span class="s2">tr key</span><span class="s4">={</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">id</span><span class="s4">}</span><span class="s2"> className</span><span class="s4">={</span><span class="s5">`bg-white border-b hover:bg-gray-50 </span><span class="s4">${</span><span class="s2">selectedActivityIds</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">id</span><span class="s4">)</span><span class="s2"> </span><span class="s4">?</span><span class="s2"> </span><span class="s5">'bg-blue-50'</span><span class="s2"> </span><span class="s4">:</span><span class="s2"> </span><span class="s5">''</span><span class="s4">}</span><span class="s5">`</span><span class="s4">}&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s2">td className</span><span class="s4">=</span><span class="s5">"p-4"</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                        </span></span><span class="s4">&lt;</span><span class="s2">input </span><span class="s1">type</span><span class="s4">=</span><span class="s5">"checkbox"</span></p>
<p class="p7"><span class="s6"><span class="Apple-converted-space">                                            </span>className</span><span class="s4">=</span><span class="s2">"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                            </span>checked</span><span class="s4">={</span><span class="s2">selectedActivityIds</span><span class="s4">.</span><span class="s2">has</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">id</span><span class="s4">)}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                            </span>onChange</span><span class="s4">={()</span><span class="s2"> </span><span class="s4">=&gt;</span><span class="s2"> handleSelectSingle</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">id</span><span class="s4">)}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                        </span>/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;/</span><span class="s2">td</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s2">td className</span><span class="s4">=</span><span class="s5">"px-4 py-3 font-medium text-gray-900 whitespace-nowrap"</span><span class="s4">&gt;{</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">id</span><span class="s4">}&lt;/</span><span class="s2">td</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s2">td className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s4">&gt;{</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">name</span><span class="s4">}&lt;/</span><span class="s2">td</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s2">td className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s4">&gt;{</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">startDate</span><span class="s4">}&lt;/</span><span class="s2">td</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s2">td className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s4">&gt;{</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">finishDate</span><span class="s4">}&lt;/</span><span class="s2">td</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s2">td className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s4">&gt;{</span><span class="s2">parseFloat</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">percentComplete </span><span class="s4">||</span><span class="s2"> </span><span class="s9">0</span><span class="s4">).</span><span class="s2">toFixed</span><span class="s4">(</span><span class="s9">1</span><span class="s4">)}</span><span class="s2">%&lt;/td</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span></span><span class="s4">&lt;</span><span class="s2">td className</span><span class="s4">=</span><span class="s5">"px-4 py-3"</span><span class="s2">&gt;&lt;span className</span><span class="s4">={</span><span class="s5">`px-2 py-1 rounded-full text-xs font-medium </span><span class="s4">${</span><span class="s2">parseFloat</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">percentComplete</span><span class="s4">)</span><span class="s2"> </span><span class="s4">&gt;=</span><span class="s2"> </span><span class="s9">100</span><span class="s2"> </span><span class="s4">?</span><span class="s2"> </span><span class="s5">'bg-green-100 text-green-800'</span><span class="s2"> </span><span class="s4">:</span><span class="s2"> parseFloat</span><span class="s4">(</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">percentComplete</span><span class="s4">)</span><span class="s2"> </span><span class="s4">&gt;</span><span class="s2"> </span><span class="s9">0</span><span class="s2"> </span><span class="s4">?</span><span class="s2"> </span><span class="s5">'bg-yellow-100 text-yellow-800'</span><span class="s2"> </span><span class="s4">:</span><span class="s2"> </span><span class="s5">'bg-gray-100 text-gray-800'</span><span class="s4">}</span><span class="s5">`</span><span class="s4">}&gt;{</span><span class="s2">activity</span><span class="s4">.</span><span class="s2">status</span><span class="s4">}&lt;/</span><span class="s2">span&gt;&lt;/td</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span></span><span class="s4">&lt;/</span><span class="s2">tr</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s4">))}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s4">&lt;/</span><span class="s2">tbody</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">&lt;/</span><span class="s2">table</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">&lt;</span><span class="s3">Pagination</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>totalItems</span><span class="s4">={</span><span class="s2">displayData</span><span class="s4">.</span><span class="s2">length</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>itemsPerPage</span><span class="s4">={</span><span class="s2">itemsPerPage</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>currentPage</span><span class="s4">={</span><span class="s2">currentPage</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>onPageChange</span><span class="s4">={</span><span class="s2">setCurrentPage</span><span class="s4">}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s4">{</span><span class="s2">displayData</span><span class="s4">.</span><span class="s2">length </span><span class="s4">===</span><span class="s2"> </span><span class="s9">0</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> filteredData</span><span class="s4">.</span><span class="s2">length </span><span class="s4">&gt;</span><span class="s2"> </span><span class="s9">0</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">&lt;</span><span class="s2">p className</span><span class="s4">=</span><span class="s5">"text-center text-sm text-gray-600 mt-4 py-8"</span><span class="s4">&gt;</span><span class="s3">No</span><span class="s2"> activities match your search query</span><span class="s4">.&lt;/</span><span class="s2">p</span><span class="s4">&gt;}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">              </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>&lt;/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">)}</span></p>
<p class="p3"><span class="s7"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">{</span><span class="s2">viewMode </span><span class="s4">===</span><span class="s2"> </span><span class="s5">'dataCentre'</span><span class="s2"> </span><span class="s4">&amp;&amp;</span><span class="s2"> structuredData </span><span class="s4">&amp;&amp;</span><span class="s2"> </span><span class="s4">(</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s4">&lt;</span><span class="s3">StructuredView</span><span class="s2"> data</span><span class="s4">={</span><span class="s2">structuredData</span><span class="s4">}</span><span class="s2"> onExport</span><span class="s4">={</span><span class="s2">exportDataCentreCSV</span><span class="s4">}</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">          </span></span><span class="s4">)}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">&lt;/</span><span class="s2">main</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">      </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s4">&lt;/</span><span class="s2">div</span><span class="s4">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s4">);</span></p>
<p class="p6"><span class="s2">}</span></p>
<p class="p3"><span class="s7"></span><br></p>
</body>
</html>
